<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Yearly Life Betterment Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#020617;--bg-elevated:#0b1120;--accent:#22c55e;--accent-soft:rgba(34,197,94,.14);
      --text-main:#f9fafb;--text-muted:#9ca3af;--border-subtle:#1f2937;--danger:#ef4444;
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    body{
      margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:radial-gradient(circle at top,#1f2937,#020617 55%);color:var(--text-main);
      min-height:100vh;display:flex;flex-direction:column;
    }
    .app-shell{flex:1;max-width:1100px;margin:0 auto;display:flex;flex-direction:column}
    header{padding:14px 14px 6px;display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    .title-block{display:flex;flex-direction:column;gap:2px}
    .title-block h1{margin:0;font-size:1.05rem;letter-spacing:.04em;text-transform:uppercase}
    .title-block span{font-size:.75rem;color:var(--text-muted)}
    .pill{
      border-radius:999px;border:1px solid rgba(148,163,184,.5);padding:6px 10px;font-size:.75rem;
      display:inline-flex;align-items:center;gap:6px;color:var(--text-muted);background:rgba(15,23,42,.9);cursor:pointer
    }
    .pill-dot{width:8px;height:8px;border-radius:999px;background:var(--accent);box-shadow:0 0 0 6px rgba(34,197,94,.25)}
    main{flex:1;padding:0 10px 70px}

    .group-strip{display:flex;gap:8px;padding:4px 0 6px;overflow-x:auto;scrollbar-width:none}
    .group-strip::-webkit-scrollbar{display:none}
    .group-chip{
      white-space:nowrap;padding:6px 12px;border-radius:999px;border:1px solid var(--border-subtle);
      background:rgba(15,23,42,.9);font-size:.8rem;color:var(--text-muted);cursor:pointer;flex-shrink:0
    }
    .group-chip.active{background:var(--accent-soft);border-color:var(--accent);color:var(--text-main);font-weight:600}

    .tab-strip{display:flex;gap:6px;padding:0 0 8px;overflow-x:auto;scrollbar-width:none}
    .tab-strip::-webkit-scrollbar{display:none}
    .tab-chip{
      white-space:nowrap;padding:5px 10px;border-radius:999px;border:1px solid var(--border-subtle);
      background:rgba(15,23,42,.9);font-size:.75rem;color:var(--text-muted);cursor:pointer;flex-shrink:0
    }
    .tab-chip.active{background:rgba(34,197,94,.18);border-color:var(--accent);color:var(--text-main);font-weight:600}

    .card{
      background:rgba(15,23,42,.96);border-radius:18px;border:1px solid var(--border-subtle);
      box-shadow:0 18px 45px rgba(0,0,0,.6),0 0 0 1px rgba(148,163,184,.18) inset;
      padding:12px;margin-top:4px
    }
    .card-header{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap}
    .card-header h2{margin:0;font-size:.95rem}
    .card-header span{font-size:.75rem;color:var(--text-muted)}
    .badge{
      border-radius:999px;padding:5px 10px;border:1px solid var(--border-subtle);font-size:.7rem;color:var(--text-muted);
      background:rgba(15,23,42,.9);display:inline-flex;align-items:center;gap:4px
    }
    .badge span{color:var(--accent)}

    .week-pill{
      border-radius:999px;padding:5px 10px;border:1px solid var(--border-subtle);font-size:.8rem;color:var(--text-muted);
      display:inline-flex;align-items:center;gap:6px;cursor:pointer;background:rgba(15,23,42,.9)
    }
    .week-pill strong{color:var(--text-main);font-weight:500}

    .table-wrapper{
      margin-top:4px;border-radius:12px;background:radial-gradient(circle at top left,rgba(34,197,94,.16),rgba(15,23,42,.94));
      overflow:auto;border:1px solid rgba(31,41,55,.95)
    }
    table{width:100%;border-collapse:collapse;font-size:.75rem;min-width:100%}
    thead{background:linear-gradient(to right,rgba(15,23,42,.9),rgba(15,23,42,.75));position:sticky;top:0;z-index:1}
    th,td{padding:6px 4px;text-align:center;border-bottom:1px solid rgba(31,41,55,.9);vertical-align:top}
    th:first-child,td:first-child{text-align:left;padding-left:10px}
    tbody tr:last-child td{border-bottom:none}
    tbody tr:nth-child(even){background:rgba(15,23,42,.85)}
    tbody tr:nth-child(odd){background:rgba(15,23,42,.7)}

    .category-label{font-weight:500;font-size:.78rem}
    .category-label span{display:block;font-size:.7rem;color:var(--text-muted);font-weight:400}

    .small-input,
    input.log-input,select.log-input,textarea.log-input{
      width:100%;padding:4px 4px;border-radius:8px;border:1px solid rgba(55,65,81,.9);
      background:rgba(15,23,42,.9);color:var(--text-main);font-size:.72rem
    }
    .small-input{max-width:64px;text-align:center}
    .small-input:focus,input.log-input:focus,select.log-input:focus,textarea.log-input:focus{
      outline:1px solid var(--accent);box-shadow:0 0 0 1px rgba(34,197,94,.4)
    }
    textarea.log-input{resize:vertical;min-height:70px}
    textarea.log-input.big{min-height:120px}

    .summary-row{background:rgba(15,23,42,1)}
    .summary-row td{font-size:.75rem;color:var(--text-muted);border-top:1px solid rgba(31,41,55,.95)}
    .summary-label{font-weight:500;color:var(--text-main)}
    .summary-value{color:var(--accent);font-weight:500;text-align:right;padding-right:12px}

    .controls-row{display:flex;flex-wrap:wrap;justify-content:flex-end;gap:6px;margin-top:6px;font-size:.7rem}
    .btn{
      border-radius:999px;padding:5px 10px;border:1px solid rgba(55,65,81,.9);background:rgba(15,23,42,.98);
      color:var(--text-muted);cursor:pointer;display:inline-flex;align-items:center;gap:4px
    }
    .btn-primary{border-color:var(--accent);background:var(--accent-soft);color:var(--text-main)}
    .btn-danger{border-color:rgba(239,68,68,.7);color:#fecaca}

    .helper-text{margin-top:8px;font-size:.7rem;color:var(--text-muted);display:flex;align-items:flex-start;gap:6px}
    .helper-dot{width:8px;height:8px;border-radius:999px;background:var(--accent);margin-top:4px}

    .analytics-grid{margin-top:10px;display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:6px}
    .analytics-card{border-radius:12px;border:1px solid rgba(31,41,55,.9);background:rgba(15,23,42,.96);padding:6px 8px;font-size:.72rem}
    .analytics-label{color:var(--text-muted)}
    .analytics-value{color:var(--accent);font-weight:600;font-size:.8rem;margin-top:2px}

    .bottom-nav{
      position:fixed;bottom:0;left:0;right:0;max-width:1100px;margin:0 auto;padding:6px 9px 10px;
      background:linear-gradient(to top,rgba(15,23,42,.98),rgba(15,23,42,.94));border-top:1px solid rgba(31,41,55,.95);
      display:flex;justify-content:space-between;gap:6px;backdrop-filter:blur(18px)
    }
    .nav-btn{
      flex:1;border-radius:999px;padding:6px 6px;border:1px solid rgba(31,41,55,.9);background:rgba(15,23,42,.98);
      font-size:.7rem;color:var(--text-muted);display:flex;flex-direction:column;align-items:center;gap:2px;cursor:pointer
    }
    .nav-btn svg{width:16px;height:16px;opacity:.75}
    .nav-btn span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nav-btn.active{border-color:var(--accent);background:var(--accent-soft);color:var(--text-main)}
    .nav-btn.active svg{opacity:1}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="title-block">
        <h1>Yearly Life Betterment</h1>
        <span>All your 2026 trackers in one phone app</span>
      </div>

      <div style="display:flex; gap:8px; align-items:center;">
        <div class="pill" style="cursor:default;">
          <div class="pill-dot"></div>
          <span>Offline Â· Stored on this device</span>
        </div>
        <button type="button" class="pill" onclick="exportAllCsv()">
          <span>ðŸ“¤ Export all data (one CSV)</span>
        </button>
        <button type="button" class="pill" onclick="exportAllXlsx()">
          <span>ðŸ“¦ Export all data (Excel .xlsx)</span>
        </button>
      </div>
    </header>

    <main>
      <div class="group-strip" id="groupStrip"></div>
      <div class="tab-strip" id="tabStrip"></div>
      <section id="screenContainer"></section>
    </main>
  </div>

  <nav class="bottom-nav" id="bottomNav"></nav>

  <script>

    const STORAGE_KEY = "bettermentTracker_v5_singleExport_full";

    const appConfig = {
      groups: [
        { id: "life", label: "Life & Reflection", icon: "life", tabs: [
          { id: "week_tracker", label: "Week Tracker", type: "weekGrid" },
          { id: "personal_tracker", label: "Daily Personal", type: "log_personal" },
          { id: "highlights", label: "Weekly Wins", type: "log_highlights" },
          { id: "month_view", label: "Month View", type: "log_month" }
        ]},
        { id: "health", label: "Health & Fitness", icon: "health", tabs: [
          { id: "weight_fitness", label: "Weight & Steps", type: "log_weight" },
          { id: "mammoth", label: "Mammoth Tracker", type: "log_mammoth" },
          { id: "marathon_plan", label: "Marathon Training Plan (Ref)", type: "ref_marathon" }
        ]},
        { id: "disc", label: "Disc Golf", icon: "disc", tabs: [
          { id: "dg_practice", label: "Practice Log", type: "log_dg_practice" },
          { id: "dg_round", label: "Round Log", type: "log_dg_round" },
          { id: "dg_tournament", label: "Tournament Log", type: "log_dg_tournament" },
          { id: "vetsdg", label: "Vets DG Outreach", type: "log_vetsdg" }
        ]},
        { id: "youtube", label: "YouTube", icon: "youtube", tabs: [
          { id: "yt_long_videos", label: "Long Videos", type: "yt_sheet", sheet: "Long Videos", editable: true },
          { id: "yt_shorts", label: "Shorts", type: "yt_sheet", sheet: "Shorts", editable: true },
          { id: "yt_filming_checklist", label: "Filming Checklist", type: "yt_sheet", sheet: "Filming Checklist", editable: true },
          { id: "yt_monthly_review", label: "Monthly Review", type: "yt_sheet", sheet: "Monthly Review", editable: true },
          { id: "yt_long_script_template", label: "Long Script Template", type: "yt_sheet", sheet: "Long Script Template", editable: false },
          { id: "yt_short_script_template", label: "Short Script Template", type: "yt_sheet", sheet: "Short Script Template", editable: false },
          { id: "yt_pillar_logic", label: "Pillar Logic", type: "yt_sheet", sheet: "Pillar Logic", editable: false },
          { id: "yt_hooks_option_1_auto", label: "Hooks â€“ Option 1 (Auto)", type: "yt_sheet", sheet: "Hooks â€“ Option 1 (Auto)", editable: false },
          { id: "yt_hooks_option_3_hybrid", label: "Hooks â€“ Option 3 (Hybrid)", type: "yt_sheet", sheet: "Hooks â€“ Option 3 (Hybrid)", editable: false },
          { id: "yt_hook_performance_analysis", label: "Hook Performance Analysis", type: "yt_sheet", sheet: "Hook Performance Analysis", editable: false }
        ]},
        { id: "skills", label: "Skills & Certs", icon: "skills", tabs: [
          { id: "guitar", label: "Guitar Practice", type: "log_guitar" },
          { id: "certs", label: "Certs Tracker", type: "log_certs" }
        ]}
      ],
      weekly: {
        days: ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],
        rows: [
          { id: "strength", label: "Strength", summary: "Strength Workouts Done" },
          { id: "walk", label: "Walk", summary: "Walk Days Done" },
          { id: "hike", label: "Hike (Long)", summary: "Total Miles" },
          { id: "weight", label: "Weight" },
          { id: "dg_practice", label: "DG Practice", summary: "Disc Golf Practice" },
          { id: "dg_round", label: "DG Round/Tournament", summary: "Disc Golf Rounds" },
          { id: "vets_local", label: "Vets Local" },
          { id: "vets_national", label: "Vets National" },
          { id: "guitar", label: "Guitar Practice" },
          { id: "crisc", label: "CRISC Study" },
          { id: "pmp", label: "PMP Study - Starts Q3" },
          { id: "water", label: "Water" },
          { id: "snacks", label: "Snacks" },
          { id: "sleep", label: "Sleep" },
          { id: "yt_plan", label: "YT Plan" },
          { id: "yt_shoot", label: "YT Shoot" },
          { id: "yt_edit", label: "YT Edit" },
          { id: "yt_upload", label: "YT Upload" },
          { id: "mental_reset", label: "Mental Reset" },
          { id: "mm_distance", label: "MM Distance" },
          { id: "mm_pack_weight", label: "MM Pack Weight" }
        ]
      }
    };

    const YT_BOOK = {"sheets": {"Long Script Template": {"headers": ["Section", "Prompt / What to Write", "Example"], "rows": [["VIDEO TITLE", " [Clear benefit + disc golf keyword + specific result]", "Fix Your Forehand Roll â€” Gain Control & Distance Fast"], ["VIDEO TYPE", " [Tutorial / Vlog / Challenge / Review]", "Tutorial"], ["PRIMARY KEYWORD", " [e.g., beginner forehand, putting drill]", "disc golf forehand beginner"], ["SECONDARY KEYWORDS", " [disc golf tips, beginner disc golf, etc.]", "forehand form disc golf; beginner disc golf tips; forehand wrist roll"], ["THUMBNAIL TEXT", " [3â€“5 word punchy phrase, e.g., FIX YOUR FOREHAND]", "STOP ROLLING IT"], ["", "", ""], ["Hook,HOOK (0â€“5s)", " [Call out the problem + promise the solution in plain language]", " \"If your forehand wobbles or burns over, this one mistake is killing your throw.\""], ["Hook,Example", " \"Youâ€™re losing distance on your forehand because of THIS mistake. Letâ€™s fix it in a few minutes.\"", " Call out the mistake and promise a quick fix"], ["", "", ""], ["Intro,INTRO (5â€“15s)", " [Who you are + what this video will do for them]", " \"Iâ€™m Bryan with BP Disc Golfing Dad, helping beginners throw with confidence. Today Iâ€™ll show you how to stop rolling your wrist so your forehand flies cleaner and farther.\""], ["Intro,Example", " \"Iâ€™m Bryan with BP Disc Golfing Dadâ€”helping beginners throw with confidence. Today youâ€™ll learn ______ so you can ______.\"", " Who you are + what theyâ€™ll gain"], ["", "", ""], ["Context,WHO THIS IS FOR", " [Beginners / Rec players / People struggling with X]", " beginners or rec players struggling with forehand consistency"], ["Context,WHY IT MATTERS", " [Short explanation of the pain point and payoff]", " wrist roll causes wobble, early turn, lost distance, and frustration"], ["", "", ""], ["Section 1 - Problem,SECTION TITLE", " [Whatâ€™s going wrong]", " The Wrist Roll Problem"], ["Section 1 - Problem,Describe the common mistake in simple terms", "", " players try to flick their wrist for power"], ["Section 1 - Problem,Describe what it looks like (visible symptoms)", "", " wrist turns over, disc comes out wobbly or nose down"], ["Section 1 - Problem,Describe what it causes on the course (scores, frustration)", "", " early turnover, inconsistent release, lost distance"], ["Section 1 - Problem,B-ROLL NOTES", " [Clips of bad form / missed putts / early releases]", " exaggerated bad forehand; slow-mo wobble; burned-over shot"], ["", "", ""], ["Section 2 - Concept,SECTION TITLE", " [The core idea / fix]", " How a Clean Forehand Works"], ["Section 2 - Concept,Explain the correct concept in 1â€“2 simple sentences", "", " power comes from elbow lead, not wrist roll"], ["Section 2 - Concept,Use an analogy (hammer, door, whip, rail, etc.)", "", " throwing a hammer straight forward, not flipping it"], ["Section 2 - Concept,Highlight 1â€“3 key checkpoints (e.g., elbow leads, wrist neutral)", "", " elbow leads; wrist neutral; palm facing target"], ["Section 2 - Concept,B-ROLL NOTES", " [Slow-mo of correct form, freeze frame on checkpoints]", " slow-mo correct form; freeze frame on wrist position"], ["", "", ""], ["Section 3 - Drill 1,SECTION TITLE", " [Drill name #1]", " Towel Forehand Drill"], ["Section 3 - Drill 1,Purpose", " [What this drill fixes]", " removes disc and isolates wrist position"], ["Section 3 - Drill 1,Step-by-step instructions (1â€“5)", "", " 1 hold towel flat 2 slow forehand motion 3 snap straight forward"], ["Section 3 - Drill 1,Common mistakes during the drill", "", " rolling wrist; muscling with arm"], ["Section 3 - Drill 1,Coaching cues", " [\"Feel likeâ€¦\", \"Focus onâ€¦\"]", " \"Keep the towel flat\"; \"Elbow first, wrist last\""], ["Section 3 - Drill 1,How many reps / sets to do", "", " 20 reps x 2 sets"], ["Section 3 - Drill 1,B-ROLL NOTES", " [Front and side angle of drill]", " front and side angles of towel drill"], ["", "", ""], ["Section 4 - Drill 2 (optional),SECTION TITLE", " [Drill name #2]", " Standstill Forehand Throws"], ["Section 4 - Drill 2,Purpose", " [Secondary fix or progression]", " apply drill to real disc without footwork"], ["Section 4 - Drill 2,Step-by-step instructions (1â€“5)", "", " standstill; slow pull; controlled release"], ["Section 4 - Drill 2,What they should feel when doing it right", "", " smooth snap with no wobble"], ["Section 4 - Drill 2,How to know theyâ€™re improving", "", " straighter flights; cleaner release"], ["Section 4 - Drill 2,B-ROLL NOTES", " [Slow-mo, close-ups, footwork, grip]", " before vs after standstill throws"], ["", "", ""], ["Section 5 - Full Motion,SECTION TITLE", " [Put it together]", " Add Footwork Back In"], ["Section 5 - Full Motion,Explain how to go from drill to full throw/putt", "", " towel â†’ standstill â†’ one-step â†’ full throw"], ["Section 5 - Full Motion,Progression", " [Standstill â†’ one-step â†’ full run-up]", " increase power only after clean release"], ["Section 5 - Full Motion,Remind them of 1â€“2 key focus points", "", " elbow leads; wrist stays neutral"], ["Section 5 - Full Motion,B-ROLL NOTES", " [Before/after clips, flight paths, real throws]", " full-speed throw + slow-mo replay"], ["", "", ""], ["Practice Plan,PRACTICE PLAN INTRO", " [\"Hereâ€™s exactly how to train thisâ€¦\"]", " \"Hereâ€™s how to train this during the week"], ["Practice Plan,Day 1â€“2", " [Example plan â€“ reps, sets, focuses]", " towel drill + 10 standstill throws"], ["Practice Plan,Day 3â€“4", " [Add second drill or more distance]", " standstill throws only; focus on clean release"], ["Practice Plan,Day 5â€“7", " [Mix in course application or field work]", " light fieldwork; record yourself"], ["Practice Plan,Expected timeline to see improvement (e.g., 1â€“2 weeks)", "", " improvement in 1â€“2 weeks"], ["", "", ""], ["Recap,RECAP KEY POINTS (bullet style in script)", "", ""], ["Recap,\"1) ______\"", "", "\"1) Stop flicking the wrist\""], ["Recap,\"2) ______\"", "", "\"2) Lead with the elbow\""], ["Recap,\"3) ______\"", "", "\"3) Keep the wrist neutral\""], ["Recap,One sentence summary of the transformation", " [\"Do THIS instead of THAT and youâ€™ll ______.\"]", "Transformation"], ["", "", ""], ["CTA,PRIMARY CTA", " [Comment prompt â€“ ask a question or invite feedback]", " Ask viewer engagement question"], ["CTA,Example", " \"Tell me in the comments what part of your forehand gives you the most trouble.\"", " \"Comment if your forehand is your weakest shot.\""], ["CTA,SECOND CTA", " [Subscribe / next video suggestion]", " Subscribe reminder"], ["CTA,Example", " \"If this helped, subscribe for more beginner disc golf tips every other week.\"", " \"Subscribe for beginner disc golf tips every other week.\""], ["CTA,OPTIONAL END CARD HOOK", " [Mention related video or playlist to watch next]", " Watch next video on forehand grip"], ["", "", ""], ["Notes,VIDEO NOTES", " [Any reminders for filming location, weather, gear, outfit, sponsors]", " film in open field with clear background"], ["Notes,SPONSOR / SHOUTOUT NOTES", " [Vets Disc Golf, local shops, etc.]", " mention Vets Disc Golf"], ["Notes,EDITING NOTES", " [Text on screen, slow-mo moments, arrows, labels]", " arrows on wrist; slow-mo overlays"], ["Notes,THUMBNAIL IDEAS", " [Face emotion, disc shown, text placement, background]", " shocked face + forehand grip + bold text"], ["Notes,POSTING NOTES", " [Title variations, description links, hashtags, pin comment idea]", ""]]}, "Short Script Template": {"headers": ["Section/Prompt", "What to Write", "Example"], "rows": [["VIDEO TITLE", " [Short and searchable title â€” e.g., \"Stop Throwing Nose-Up!\"]", "Stop Rolling Your Forehand Wrist"], ["SHORT TYPE", " [Tip / Drill / Review / Motivation / Teaser]", "Quick Tip"], ["PRIMARY KEYWORD", " [disc golf beginner / putting drill]", "disc golf forehand beginner"], ["", "", ""], ["Hook,HOOK (0â€“2s)", " [Call out the problem or promise the benefit]", " \"Your forehand wobbles because of THIS.\""], ["Hook,Example", " \"Stop throwing nose-up!\"", " fast visual of bad wobble forehand"], ["", "", ""], ["Problem,WHAT'S WRONG", " [Describe issue in 1 short sentence]", " you're flicking your wrist for power"], ["Problem,Example", " \"You're tilting the disc up and losing distance.\"", " exaggerated wrist roll causing turnover"], ["", "", ""], ["Fix,MAIN TIP / DRILL", " [Explain the fix in simple terms â€” one idea only]", " lead with your elbow and keep the wrist neutral"], ["Fix,Example", " \"Keep your wrist neutral and shoulder level.\"", " hammer analogy â€” elbow first, wrist follows"], ["", "", ""], ["Demo,DEMO VISUAL", " [Show quick rep, slow-mo, or angle change]", " towel drill or slow standstill forehand"], ["Demo,Examples", " before/after clips, angle comparison, grip close-up", " side angle clean release; no wobble flight"], ["", "", ""], ["Recap,RECAP ONE SENTENCE", " [Summarize the fix]", " elbow leads, wrist stays neutral, forehand flies clean"], ["Recap,Example", " \"Elbow leads, wrist neutral, disc flat.\"", " text on screen summarizing the tip"], ["", "", ""], ["CTA,CALL TO ACTION", " [Engagement + funnel to long video]", " watch the full breakdown on my channel"], ["CTA,Examples", " \"Try it today and comment how it worked!\" OR \"Full fix on my channel.\"", " follow for beginner disc golf tips"]]}, "Long Videos": {"headers": ["Week", "Pillar", "Publish Week", "Title", "Primary Keyword", "On-Screen Text", "Caption Template", "Filmed", "Edited", "Scheduled", "Published", "Video URL", "Recording Style", "Hook Used", "Views", "CTR %", "Avg View Duration", "Saves", "Date Published", "Notes (Performance)", "Recommended Length (min)"], "rows": [["1", "", "2026-01-05", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["3", "", "2026-01-19", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["5", "", "2026-02-02", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["7", "", "2026-02-16", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["9", "", "2026-03-02", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["11", "", "2026-03-16", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["13", "", "2026-03-30", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["15", "", "2026-04-13", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["17", "", "2026-04-27", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["19", "", "2026-05-11", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["21", "", "2026-05-25", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["23", "", "2026-06-08", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["25", "", "2026-06-22", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["27", "", "2026-07-06", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["29", "", "2026-07-20", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["31", "", "2026-08-03", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["33", "", "2026-08-17", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["35", "", "2026-08-31", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["37", "", "2026-09-14", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["39", "", "2026-09-28", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["41", "", "2026-10-12", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["43", "", "2026-10-26", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["45", "", "2026-11-09", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["47", "", "2026-11-23", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["49", "", "2026-12-07", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"], ["51", "", "2026-12-21", "", "", "", "", "No", "No", "No", "No", "", "", "", "", "", "", "", "", "", "8â€“15"]]}, "Shorts": {"headers": ["Week", "Pillar", "Publish Week", "Title", "Primary Keyword", "On-Screen Text", "Caption Template", "Filmed", "Scheduled", "Published", "URL", "Recording Style", "Date Published", "Notes", "Recommended Length (sec)"], "rows": [["1", "", "2026-01-05", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["2", "", "2026-01-12", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["3", "", "2026-01-19", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["4", "", "2026-01-26", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["5", "", "2026-02-02", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["6", "", "2026-02-09", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["7", "", "2026-02-16", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["8", "", "2026-02-23", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["9", "", "2026-03-02", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["10", "", "2026-03-09", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["11", "", "2026-03-16", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["12", "", "2026-03-23", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["13", "", "2026-03-30", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["14", "", "2026-04-06", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["15", "", "2026-04-13", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["16", "", "2026-04-20", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["17", "", "2026-04-27", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["18", "", "2026-05-04", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["19", "", "2026-05-11", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["20", "", "2026-05-18", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["21", "", "2026-05-25", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["22", "", "2026-06-01", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["23", "", "2026-06-08", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["24", "", "2026-06-15", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["25", "", "2026-06-22", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["26", "", "2026-06-29", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["27", "", "2026-07-06", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["28", "", "2026-07-13", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["29", "", "2026-07-20", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["30", "", "2026-07-27", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["31", "", "2026-08-03", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["32", "", "2026-08-10", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["33", "", "2026-08-17", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["34", "", "2026-08-24", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["35", "", "2026-08-31", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["36", "", "2026-09-07", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["37", "", "2026-09-14", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["38", "", "2026-09-21", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["39", "", "2026-09-28", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["40", "", "2026-10-05", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["41", "", "2026-10-12", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["42", "", "2026-10-19", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["43", "", "2026-10-26", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["44", "", "2026-11-02", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["45", "", "2026-11-09", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["46", "", "2026-11-16", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["47", "", "2026-11-23", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["48", "", "2026-11-30", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["49", "", "2026-12-07", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["50", "", "2026-12-14", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["51", "", "2026-12-21", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"], ["52", "", "2026-12-28", "", "", "", "", "No", "No", "No", "", "", "", "", "20â€“45"]]}, "Filming Checklist": {"headers": ["Phase", "Task", "Done"], "rows": [["PRE-FILM", "Pick 1 long + 1 short", "False"], ["PRE-FILM", "Write hook (5â€“7 sec)", "False"], ["PRE-FILM", "Choose 1 takeaway sentence", "False"], ["PRE-FILM", "Decide B-roll shots needed", "False"], ["PRE-FILM", "Charge phone / camera / mic", "False"], ["PRE-FILM", "Wear branded or neutral shirt", "False"], ["FILM DAY", "Film long video A-roll", "False"], ["FILM DAY", "Film 2â€“3 Shorts", "False"], ["FILM DAY", "Tee shots", "False"], ["FILM DAY", "Putting close-ups", "False"], ["FILM DAY", "Walking B-roll", "False"], ["FILM DAY", "Say CTA once", "False"], ["POST-FILM", "Rename files (Date_Title)", "False"], ["POST-FILM", "Drop into editing folder", "False"], ["POST-FILM", "Pull 2 Shorts from long video", "False"], ["POST-FILM", "Add captions (REQUIRED)", "False"], ["POST-FILM", "Save thumbnail frame", "False"], ["THUMBNAILS", "Big face / disc / motion", "False"], ["THUMBNAILS", "2â€“4 bold words", "False"], ["THUMBNAILS", "High contrast", "False"], ["THUMBNAILS", "Same font", "False"], ["UPLOAD", "Title (keyword first)", "False"], ["UPLOAD", "Description (2â€“3 sentences)", "False"], ["UPLOAD", "Pinned comment", "False"], ["UPLOAD", "Add to playlist", "False"], ["UPLOAD", "Schedule weekly", "False"], ["REVIEW", "Which videos got saves?", "False"], ["REVIEW", "Which Shorts got rewatches?", "False"], ["REVIEW", "Double down on winners", "False"]]}, "Monthly Review": {"headers": ["Month", "Prompt", "Notes"], "rows": [["Month 1", "Which videos had the highest saves?", ""], ["Month 1", "Which Shorts had rewatches >100%?", ""], ["Month 1", "Which pillar performed best?", ""], ["Month 1", "What topic felt easiest to film?", ""], ["Month 1", "What topic caused friction?", ""], ["Month 1", "What should I double down on next month?", ""], ["Month 2", "Which videos had the highest saves?", ""], ["Month 2", "Which Shorts had rewatches >100%?", ""], ["Month 2", "Which pillar performed best?", ""], ["Month 2", "What topic felt easiest to film?", ""], ["Month 2", "What topic caused friction?", ""], ["Month 2", "What should I double down on next month?", ""], ["Month 3", "Which videos had the highest saves?", ""], ["Month 3", "Which Shorts had rewatches >100%?", ""], ["Month 3", "Which pillar performed best?", ""], ["Month 3", "What topic felt easiest to film?", ""], ["Month 3", "What topic caused friction?", ""], ["Month 3", "What should I double down on next month?", ""], ["Month 4", "Which videos had the highest saves?", ""], ["Month 4", "Which Shorts had rewatches >100%?", ""], ["Month 4", "Which pillar performed best?", ""], ["Month 4", "What topic felt easiest to film?", ""], ["Month 4", "What topic caused friction?", ""], ["Month 4", "What should I double down on next month?", ""], ["Month 5", "Which videos had the highest saves?", ""], ["Month 5", "Which Shorts had rewatches >100%?", ""], ["Month 5", "Which pillar performed best?", ""], ["Month 5", "What topic felt easiest to film?", ""], ["Month 5", "What topic caused friction?", ""], ["Month 5", "What should I double down on next month?", ""], ["Month 6", "Which videos had the highest saves?", ""], ["Month 6", "Which Shorts had rewatches >100%?", ""], ["Month 6", "Which pillar performed best?", ""], ["Month 6", "What topic felt easiest to film?", ""], ["Month 6", "What topic caused friction?", ""], ["Month 6", "What should I double down on next month?", ""], ["Month 3", "Which videos had the highest saves?", ""], ["Month 7", "Which Shorts had rewatches >100%?", ""], ["Month 7", "Which pillar performed best?", ""], ["Month 7", "What topic felt easiest to film?", ""], ["Month 7", "What topic caused friction?", ""], ["Month 7", "What should I double down on next month?", ""], ["Month 8", "Which videos had the highest saves?", ""], ["Month 8", "Which Shorts had rewatches >100%?", ""], ["Month 8", "Which pillar performed best?", ""], ["Month 8", "What topic felt easiest to film?", ""], ["Month 8", "What topic caused friction?", ""], ["Month 8", "What should I double down on next month?", ""], ["Month 9", "Which videos had the highest saves?", ""], ["Month 9", "Which Shorts had rewatches >100%?", ""], ["Month 9", "Which pillar performed best?", ""], ["Month 9", "What topic felt easiest to film?", ""], ["Month 9", "What topic caused friction?", ""], ["Month 9", "What should I double down on next month?", ""], ["Month 10", "Which videos had the highest saves?", ""], ["Month 10", "Which Shorts had rewatches >100%?", ""], ["Month 10", "Which pillar performed best?", ""], ["Month 10", "What topic felt easiest to film?", ""], ["Month 10", "What topic caused friction?", ""], ["Month 10", "What should I double down on next month?", ""], ["Month 11", "Which videos had the highest saves?", ""], ["Month 11", "Which Shorts had rewatches >100%?", ""], ["Month 11", "Which pillar performed best?", ""], ["Month 11", "What topic felt easiest to film?", ""], ["Month 11", "What topic caused friction?", ""], ["Month 11", "What should I double down on next month?", ""], ["Month 12", "Which videos had the highest saves?", ""], ["Month 12", "Which Shorts had rewatches >100%?", ""], ["Month 12", "Which pillar performed best?", ""], ["Month 12", "What topic felt easiest to film?", ""], ["Month 12", "What topic caused friction?", ""], ["Month 12", "What should I double down on next month?", ""]]}, "Pillar Logic": {"headers": ["Pillar", "Description", "Ideal % Mix"], "rows": [["Form", "Throwing mechanics, power, timing", "30%"], ["Putting", "C1/C2, drills, routines", "25%"], ["Mental Game", "Confidence, pressure, mindset", "20%"], ["Course Strategy", "Shot choice, scoring, decisions", "15%"], ["Equipment & Gear", "Discs, bags, selection", "10%"]]}, "Hooks â€“ Option 1 (Auto)": {"headers": ["Pillar", "Auto Hook", "Auto Description Template"], "rows": [["Form", "Most players lose power because of this one mistakeâ€¦", "In this video, I break down [TOPIC] and how amateur disc golfers can fix it without overthinking. Simple form. Real results. Subscribe for Disc Golf 101."], ["Putting", "If you miss inside the circle, this is whyâ€¦", "Letâ€™s talk about [TOPIC] and why putting breaks down under pressure. This is how Iâ€™m building confidence and consistency inside the circle."], ["Mental Game", "This is what I tell myself after a bad holeâ€¦", "Disc golf is mental. In this video, I share how I handle [TOPIC] so one bad hole doesnâ€™t ruin the round."], ["Course Strategy", "This decision costs amateur players strokesâ€¦", "Course management matters. Hereâ€™s how [TOPIC] helps amateur players score better without throwing harder."], ["Equipment & Gear", "You donâ€™t need more discs â€” you need thisâ€¦", "Before you buy another disc, watch this. I break down [TOPIC] and how it actually helps your game."]]}, "Hooks â€“ Option 3 (Hybrid)": {"headers": ["Pillar", "Hook Option A", "Hook Option B", "Hook Option C", "Description Template"], "rows": [["Form", "Most players lose power because of thisâ€¦", "This one form mistake is killing your distanceâ€¦", "If your drives feel weak, watch thisâ€¦", "In this Disc Golf 101 video, I break down [TOPIC] so amateur players can throw cleaner and more consistently."], ["Putting", "If you miss short putts, this is whyâ€¦", "This is why your putts fall apart in roundsâ€¦", "Most players practice putting wrongâ€¦", "Putting decides scores. Hereâ€™s how Iâ€™m working on [TOPIC] to improve consistency inside the circle."], ["Mental Game", "This is how bad holes spiral roundsâ€¦", "One bad hole doesnâ€™t have to ruin your roundâ€¦", "Hereâ€™s how I reset mentally mid-roundâ€¦", "Disc golf is mental. This video breaks down [TOPIC] and how to stay composed under pressure."], ["Course Strategy", "This shot choice costs strokesâ€¦", "Stop playing hero golf on this holeâ€¦", "Smart golf beats big armsâ€¦", "Course strategy matters. I explain [TOPIC] and how amateurs can score better by playing smarter."], ["Equipment & Gear", "You donâ€™t need 20 discsâ€¦", "Stop buying discs and fix this firstâ€¦", "This disc wonâ€™t fix your gameâ€¦", "Letâ€™s talk gear. I explain [TOPIC] and what actually matters for amateur disc golfers."]]}, "Hook Performance Analysis": {"headers": ["Hook Type", "Videos Used", "Total Saves"], "rows": [["Form A", "0", "0"], ["Form B", "0", "0"], ["Form C", "0", "0"], ["Putting A", "0", "0"], ["Putting B", "0", "0"], ["Putting C", "0", "0"], ["Mental A", "0", "0"], ["Mental B", "0", "0"], ["Mental C", "0", "0"], ["Strategy A", "0", "0"], ["Strategy B", "0", "0"], ["Strategy C", "0", "0"], ["Gear A", "0", "0"], ["Gear B", "0", "0"], ["Gear C", "0", "0"], ["", "", ""], ["Insight Rule", "Meaning", ""], ["High Saves", "Viewer found value", ""], ["Low CTR", "Hook needs work", ""], ["High AVD", "Strong retention", ""]]}}, "dropdowns": {"pillars": ["Form", "Putting", "Mental Game", "Course Strategy", "Equipment & Gear"]}};


    const tabConfigs = {};
    appConfig.groups.forEach(g => g.tabs.forEach(t => (t.groupId=g.id, tabConfigs[t.id]=t)));
    // Reference table: Marathon / long-distance training plan (read-only)
    const marathonPlanRef = {"headers": ["Week", "Phase", "Week Starting", "Weekly Mileage Target", "Long Walk Distance", "Pack Weight", "Goal Pace (min/mi)", "Primary Focus", "Notes"], "rows": [["1", "Phase 1 â€“ Base Foundation", "2026-01-05", "10", "5", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["2", "Phase 1 â€“ Base Foundation", "2026-01-12", "11", "5", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["3", "Phase 1 â€“ Base Foundation", "2026-01-19", "12", "6", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["4", "Phase 1 â€“ Base Foundation", "2026-01-26", "13", "6", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["5", "Phase 1 â€“ Base Foundation", "2026-02-02", "14", "7", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["6", "Phase 1 â€“ Base Foundation", "2026-02-09", "15", "7", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["7", "Phase 1 â€“ Base Foundation", "2026-02-16", "16", "8", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["8", "Phase 1 â€“ Base Foundation", "2026-02-23", "18", "8", "", "20:00", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["9", "Phase 2 â€“ Distance & Pace", "2026-03-02", "18", "9", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["10", "Phase 2 â€“ Distance & Pace", "2026-03-09", "19", "9", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["11", "Phase 2 â€“ Distance & Pace", "2026-03-16", "20", "10", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["12", "Phase 2 â€“ Distance & Pace", "2026-03-23", "21", "10", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["13", "Phase 2 â€“ Distance & Pace", "2026-03-30", "22", "11", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["14", "Phase 2 â€“ Distance & Pace", "2026-04-06", "23", "11", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["15", "Phase 2 â€“ Distance & Pace", "2026-04-13", "24", "12", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["16", "Phase 2 â€“ Distance & Pace", "2026-04-20", "25", "12", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["17", "Phase 2 â€“ Distance & Pace", "2026-04-27", "25", "12", "5â€“10 lbs", "19:45", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["18", "Phase 3 â€“ Pack & Endurance", "2026-05-04", "25", "13", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["19", "Phase 3 â€“ Pack & Endurance", "2026-05-11", "26", "13", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["20", "Phase 3 â€“ Pack & Endurance", "2026-05-18", "27", "14", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["21", "Phase 3 â€“ Pack & Endurance", "2026-05-25", "28", "14", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["22", "Phase 3 â€“ Pack & Endurance", "2026-06-01", "29", "15", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["23", "Phase 3 â€“ Pack & Endurance", "2026-06-08", "30", "15", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["24", "Phase 3 â€“ Pack & Endurance", "2026-06-15", "31", "16", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["25", "Phase 3 â€“ Pack & Endurance", "2026-06-22", "32", "16", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["26", "Phase 3 â€“ Pack & Endurance", "2026-06-29", "32", "16", "10â€“18 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["27", "Phase 4 â€“ Peak Specificity", "2026-07-06", "30", "16", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["28", "Phase 4 â€“ Peak Specificity", "2026-07-13", "32", "18", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["29", "Phase 4 â€“ Peak Specificity", "2026-07-20", "34", "20", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["30", "Phase 4 â€“ Peak Specificity", "2026-07-27", "36", "18", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["31", "Phase 4 â€“ Peak Specificity", "2026-08-03", "38", "20", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["32", "Phase 4 â€“ Peak Specificity", "2026-08-10", "36", "16", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["33", "Phase 4 â€“ Peak Specificity", "2026-08-17", "34", "14", "18â€“20 lbs", "19:30", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["34", "Phase 5 â€“ Taper", "2026-08-24", "20", "12", "Light pack", "Easy", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["35", "Phase 5 â€“ Taper", "2026-08-31", "14", "8", "Light pack", "Easy", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"], ["36", "Phase 5 â€“ Taper", "2026-09-07", "8", "6", "Light pack", "Easy", "Build endurance & efficiency", "Fuel every 45â€“60 min on long walks"]]};


    function loadState(){ try{ const raw=localStorage.getItem(STORAGE_KEY); return raw?JSON.parse(raw):{} }catch(e){ return {} } }
    function saveState(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(appState)); }catch(e){} }

    function ensureDefaults(state){
      if(!state||typeof state!=="object") state={};
      if(!state.activeGroup) state.activeGroup="life";
      if(!state.activeTab) state.activeTab="week_tracker";
      Object.values(tabConfigs).forEach(tab=>{
        if(!state[tab.id]){
          if(tab.type==="weekGrid"){
            state[tab.id] = { weekLabel:"This Week", data:{} };
          } else if(tab.type==="yt_sheet"){
            if(tab.editable){
              const seed = (YT_BOOK.sheets[tab.sheet] && YT_BOOK.sheets[tab.sheet].rows) ? YT_BOOK.sheets[tab.sheet].rows : [];
              state[tab.id] = { rows: JSON.parse(JSON.stringify(seed)) };
            } else {
              state[tab.id] = {};
            }
          } else {
            state[tab.id] = { entries:[] };
          }
        }
      });
      return state;
    }

    let appState = ensureDefaults(loadState());

    function csvEscape(val){
      if(val===null||val===undefined) return "";
      const s=String(val);
      return /[\",\r\n]/.test(s) ? '"' + s.replace(/"/g,'""') + '"' : s;
    }

    function exportCsv(headers, rows, filename){
      const lines=[headers.map(csvEscape).join(",")];
      rows.forEach(r=>lines.push(r.map(csvEscape).join(",")));
      const blob=new Blob([lines.join("\r\n")],{type:"text/csv;charset=utf-8;"});
      const url=URL.createObjectURL(blob);
      const a=document.createElement("a");
      a.href=url;a.download=filename;
      document.body.appendChild(a);a.click();document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function exportAllCsv(){
      const lines=[];
      const addSection=(name,headers,rows)=>{
        lines.push("#TAB:"+name);
        lines.push(headers.map(csvEscape).join(","));
        rows.forEach(r=>lines.push(r.map(csvEscape).join(",")));
        lines.push("");
      };

      // Week Tracker
      {
        const state=appState.week_tracker;
        const headers=["Category",...appConfig.weekly.days,"Weekly Summary"];
        const rows=appConfig.weekly.rows.map(row=>{
          const rowData=[row.label];
          appConfig.weekly.days.forEach(day=>{
            rowData.push((state.data[row.id] && state.data[row.id][day]) || "");
          });
          rowData.push(row.summary||"");
          return rowData;
        });
        addSection("Week_Tracker",headers,rows);
      }

      // Personal
      {
        const s=appState.personal_tracker;
        const headers=["Date","Sleep (hrs)","Stress (1-5)","Energy (1-5)","Mood (1-5)","Self-Care Completed (Yes/No)","Daily Movement (Yes/No)","Screen Time Control (Yes/No)","Gratitude","Intentions for Tomorrow","Wins Today","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.sleep||"",r.stress||"",r.energy||"",r.mood||"",r.selfCare||"",r.movement||"",r.screenControl||"",r.gratitude||"",r.intentions||"",r.winsToday||"",r.notes||""]);
        addSection("Personal_Tracker",headers,rows);
      }

      // Highlights
      {
        const s=appState.highlights;
        const headers=["Week Starting","Biggest Win","Health/Fitness Win","Disc Golf Win","YouTube Win","Vets DG Win","Guitar Win","Mindset Win","Notes"];
        const rows=(s.entries||[]).map(r=>[r.weekStarting||"",r.biggestWin||"",r.healthWin||"",r.dgWin||"",r.ytWin||"",r.vetsWin||"",r.guitarWin||"",r.mindsetWin||"",r.notes||""]);
        addSection("Highlights_Wins",headers,rows);
      }

      // Month View
      {
        const s=appState.month_view;
        const headers=["Month","Overall Grade","Weight Change (+/- lbs)","Steps / Miles Total","Disc Golf Sessions (#)","Putting Avg % (C1/C1X)","Fieldwork Sessions (#)","Tournament Results (text)","Mammoth Distance Total (mi)","YouTube Uploads (#)","YouTube Avg CTR (%)","YouTube Subs Change","Vet DG Events (#)","Vet DG Membership Change","Guitar Practice Hours","Guitar BPM Progress (+/-)","Mental Health Avg (1â€“5)","Sleep Avg (hrs)","Stress Avg (1â€“5)","Rest Days (#)","Work/Life Balance Score (1â€“5)","Biggest Wins","Biggest Challenges","Lessons Learned","Adjustments for Next Month","Notes / Reflection","Monthly Score (0â€“1)"];
        const rows=(s.entries||[]).map(r=>[r.month||"",r.grade||"",r.weightChange||"",r.stepsMiles||"",r.dgSessions||"",r.puttingAvg||"",r.fieldworkSessions||"",r.tournResults||"",r.mammothMiles||"",r.ytUploads||"",r.ytCtr||"",r.ytSubsChange||"",r.vetEvents||"",r.vetMembersChange||"",r.guitarHours||"",r.guitarBpmDelta||"",r.mentalAvg||"",r.sleepAvg||"",r.stressAvg||"",r.restDays||"",r.workLifeScore||"",r.bigWins||"",r.challenges||"",r.lessons||"",r.adjustments||"",r.notes||"",r.monthScore||""]);
        addSection("Month_View",headers,rows);
      }

      // Weight Fitness
      {
        const s=appState.weight_fitness;
        const headers=["Date","Weight","Steps","Did You Walk","Miles","Did You Workout","Total Calories","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.weight||"",r.steps||"",r.didWalk||"",r.miles||"",r.didWorkout||"",r.calories||"",r.notes||""]);
        addSection("Weight_Fitness",headers,rows);
      }

      // Mammoth
      {
        const s=appState.mammoth;
        const headers=["Week #","Long Hike Goal","Actual Long Day Distance","Goal Hit","Total Miles for the Week","Pack Weight (lb)","Hydration (Good/OK/Poor)","Fuel Tested","Terrain","Blisters (Y/N)","Gear Notes"];
        const rows=(s.entries||[]).map(r=>[r.week||"",r.goalLong||"",r.actualLong||"",r.goalHit||"",r.totalMilesWeek||"",r.packWeight||"",r.hydration||"",r.fuelTested||"",r.terrain||"",r.blisters||"",r.gearNotes||""]);
        addSection("Mammoth_Tracker",headers,rows);

      // Marathon Training Plan (reference)
      {
        const headers = marathonPlanRef.headers;
        const rows = marathonPlanRef.rows;
        addSection("Marathon_Training_Plan", headers, rows);
      }
      }

      // DG Practice
      {
        const s=appState.dg_practice;
        const headers=["Date","Duration (min)","Session Type","Focus Skill","Discs Used","C1 Attempts","C1 Made","C2 Attempts","C2 Made","Forehand Reps","Backhand Reps","Fieldwork Notes","Wind","Fatigue","Result"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.duration||"",r.sessionType||"",r.focusSkill||"",r.discs||"",r.c1Att||"",r.c1Made||"",r.c2Att||"",r.c2Made||"",r.fhReps||"",r.bhReps||"",r.notes||"",r.wind||"",r.fatigue||"",r.result||""]);
        addSection("DG_Practice_Log",headers,rows);
      }

      // DG Round
      {
        const s=appState.dg_round;
        const headers=["Date","Course","Layout","Total Holes","Par","Score","Diff to Par","C1% (0-33ft)","C1X % 6-33ft","C2 %","Misses inside 20ft","Penalties","OBs","Lost Discs","Wind","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.course||"",r.layout||"",r.totalHoles||"",r.par||"",r.score||"",r.diffToPar||"",r.c1Pct||"",r.c1xPct||"",r.c2Pct||"",r.miss20||"",r.penalties||"",r.obs||"",r.lostDiscs||"",r.wind||"",r.notes||""]);
        addSection("DG_Round_Log",headers,rows);
      }

      // DG Tournament
      {
        const s=appState.dg_tournament;
        const headers=["Date","Event","Course(s)","Division","Round Scores","Total Participants","Place","C1X %","C1 %","C2 %","Missed Inside 20ft","Notes","Takeaways"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.event||"",r.courses||"",r.division||"",r.roundScores||"",r.totalPlayers||"",r.place||"",r.c1x||"",r.c1||"",r.c2||"",r.miss20||"",r.notes||"",r.takeaways||""]);
        addSection("DG_Tournament_Log",headers,rows);
      }

      // VetsDG
      {
        const s=appState.vetsdg;
        const headers=["Date","Entry Type","Event Name/Organization","Category","Sponsors","Outreach","Attendance","Donation","Contact Status","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.entryType||"",r.eventName||"",r.category||"",r.sponsors||"",r.outreach||"",r.attendance||"",r.donation||"",r.contactStatus||"",r.notes||""]);
        addSection("VetsDG_Tracker",headers,rows);
      }

      // YouTube sheets (from spreadsheet)
      {
        const ytGroup = appConfig.groups.find(g=>g.id==="youtube");
        (ytGroup ? ytGroup.tabs : []).forEach(t=>{
          const sh = YT_BOOK.sheets[t.sheet] || { headers:[], rows:[] };
          const headers = sh.headers || [];
          const rows = (t.editable ? ((appState[t.id] && appState[t.id].rows) || []) : (sh.rows || []));
          const safeName = "YouTube_" + String(t.sheet||"").replace(/[^a-z0-9]+/gi,"_").replace(/^_+|_+$/g,"");
          addSection(safeName, headers, rows);
        });
      }
// Guitar
      {
        const s=appState.guitar;
        const headers=["Date","Practice Length (mins)","Focus Area","Technique Skill","BPM Goal","BPM Achieved","BPM Success %","Song/Exercise","Difficulty (1-5)","Feeling","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.length||"",r.focus||"",r.technique||"",r.bpmGoal||"",r.bpmAchieved||"",r.bpmSuccess||"",r.song||"",r.difficulty||"",r.feeling||"",r.notes||""]);
        addSection("GuitarPractice_Tracker",headers,rows);
      }

      // Certs
      {
        const s=appState.certs;
        const headers=["Date","Cert (CRISC/PMP)","Domain/Topic","Study Time (min)","Practice Qs %","Practice Exam Name","Score","Weak Areas","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.cert||"",r.domain||"",r.studyTime||"",r.practicePct||"",r.examName||"",r.score||"",r.weakAreas||"",r.notes||""]);
        addSection("Certs_Tracker",headers,rows);
      }

      const blob=new Blob([lines.join("\r\n")],{type:"text/csv;charset=utf-8;"});
      const url=URL.createObjectURL(blob);
      const a=document.createElement("a");
      a.href=url;a.download="Yearly_Life_Betterment_All.csv";
      document.body.appendChild(a);a.click();document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function safeSheetName(name){
      // Excel sheet names: max 31 chars, cannot contain : \ / ? * [ ]
      const cleaned = String(name||"Sheet")
        .replace(/[:\\/\?\*\[\]]/g," ")
        .replace(/\s+/g," ")
        .trim();
      return (cleaned.length>31 ? cleaned.slice(0,31) : cleaned) || "Sheet";
    }

    function exportAllXlsx(){
      if(typeof XLSX === "undefined"){
        alert("Excel export library failed to load. If you're offline, connect once or use CSV export.");
        return;
      }

      const wb = XLSX.utils.book_new();

      const addSheet = (name, rows2d) => {
        const ws = XLSX.utils.aoa_to_sheet(rows2d);
        XLSX.utils.book_append_sheet(wb, ws, safeSheetName(name));
      };

      // Week Tracker
      {
        const state=appState.week_tracker;
        const headers=["Category",...appConfig.weekly.days,"Weekly Summary"];
        const rows=appConfig.weekly.rows.map(r=>{
          const rd=[r.label];
          appConfig.weekly.days.forEach(d=>rd.push((state.data[r.id] && state.data[r.id][d]) || ""));
          rd.push(r.summary||"");
          return rd;
        });
        addSheet("Week_Tracker", [headers, ...rows]);
      }

      // Personal Tracker
      {
        const s=appState.personal_tracker;
        const headers=["Date","Sleep (hrs)","Stress (1-5)","Energy (1-5)","Mood (1-5)","Self-Care Completed (Yes/No)","Daily Movement (Yes/No)","Screen Time Control (Yes/No)","Gratitude","Intentions for Tomorrow","Wins Today","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.sleep||"",r.stress||"",r.energy||"",r.mood||"",r.selfCare||"",r.movement||"",r.screenControl||"",r.gratitude||"",r.intentions||"",r.winsToday||"",r.notes||""]);
        addSheet("Personal_Tracker", [headers, ...rows]);
      }

      // Highlights
      {
        const s=appState.highlights;
        const headers=["Week Starting","Biggest Win","Health/Fitness Win","Disc Golf Win","YouTube Win","Vets DG Win","Guitar Win","Mindset Win","Notes"];
        const rows=(s.entries||[]).map(r=>[r.weekStarting||"",r.biggestWin||"",r.healthWin||"",r.dgWin||"",r.ytWin||"",r.vetsWin||"",r.guitarWin||"",r.mindsetWin||"",r.notes||""]);
        addSheet("Highlights_Wins", [headers, ...rows]);
      }

      // Month View
      {
        const s=appState.month_view;
        const headers=["Month", "Overall Grade", "Weight Change (+/- lbs)", "Steps / Miles Total", "Disc Golf Sessions (#)", "Putting Avg % (C1/C1X)", "Fieldwork Sessions (#)", "Tournament Results (text)", "Mammoth Distance Total (mi)", "YouTube Uploads (#)", "YouTube Avg CTR (%)", "YouTube Subs Change", "Vet DG Events (#)", "Vet DG Membership Change", "Guitar Practice Hours", "Guitar BPM Progress (+/-)", "Mental Health Avg (1\u20135)", "Sleep Avg (hrs)", "Stress Avg (1\u20135)", "Rest Days (#)", "Work/Life Balance Score (1\u20135)", "Biggest Wins", "Biggest Challenges", "Lessons Learned", "Adjustments for Next Month", "Notes / Reflection", "Monthly Score (0\u20131)"];
        const rows=(s.entries||[]).map(r=>[r.month||"",r.grade||"",r.weightChange||"",r.stepsMiles||"",r.dgSessions||"",r.puttingAvg||"",r.fieldworkSessions||"",r.tournResults||"",r.mammothMiles||"",r.ytUploads||"",r.ytCtr||"",r.ytSubsChange||"",r.vetEvents||"",r.vetMembersChange||"",r.guitarHours||"",r.guitarBpmDelta||"",r.mentalAvg||"",r.sleepAvg||"",r.stressAvg||"",r.restDays||"",r.workLifeScore||"",r.bigWins||"",r.challenges||"",r.lessons||"",r.adjustments||"",r.notes||"",r.monthScore||""]);
        addSheet("Month_View", [headers, ...rows]);
      }

      // Weight Fitness
      {
        const s=appState.weight_fitness;
        const headers=["Date","Weight","Steps","Did You Walk","Miles","Did You Workout","Total Calories","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.weight||"",r.steps||"",r.didWalk||"",r.miles||"",r.didWorkout||"",r.calories||"",r.notes||""]);
        addSheet("Weight_Fitness", [headers, ...rows]);
      }

      // Mammoth
      {
        const s=appState.mammoth;
        const headers=["Week #","Long Hike Goal","Actual Long Day Distance","Goal Hit","Total Miles for the Week","Pack Weight (lb)","Hydration (Good/OK/Poor)","Fuel Tested","Terrain","Blisters (Y/N)","Gear Notes"];
        const rows=(s.entries||[]).map(r=>[r.week||"",r.goalLong||"",r.actualLong||"",r.goalHit||"",r.totalMilesWeek||"",r.packWeight||"",r.hydration||"",r.fuelTested||"",r.terrain||"",r.blisters||"",r.gearNotes||""]);
        addSheet("Mammoth_Tracker", [headers, ...rows]);
      }

      // Marathon Plan (reference spreadsheet)
      {
        addSheet("Marathon_Training_Plan", [marathonPlanRef.headers, ...marathonPlanRef.rows]);
      }

      // DG Practice
      {
        const s=appState.dg_practice;
        const headers=["Date","Duration (min)","Session Type","Focus Skill","Discs Used","C1 Attempts","C1 Made","C2 Attempts","C2 Made","Forehand Reps","Backhand Reps","Fieldwork Notes","Wind","Fatigue","Result"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.duration||"",r.sessionType||"",r.focusSkill||"",r.discs||"",r.c1Att||"",r.c1Made||"",r.c2Att||"",r.c2Made||"",r.fhReps||"",r.bhReps||"",r.notes||"",r.wind||"",r.fatigue||"",r.result||""]);
        addSheet("DG_Practice_Log", [headers, ...rows]);
      }

      // DG Round
      {
        const s=appState.dg_round;
        const headers=["Date","Course","Layout","Total Holes","Par","Score","Diff to Par","C1% (0-33ft)","C1X % 6-33ft","C2 %","Misses inside 20ft","Penalties","OBs","Lost Discs","Wind","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.course||"",r.layout||"",r.totalHoles||"",r.par||"",r.score||"",r.diffToPar||"",r.c1Pct||"",r.c1xPct||"",r.c2Pct||"",r.miss20||"",r.penalties||"",r.obs||"",r.lostDiscs||"",r.wind||"",r.notes||""]);
        addSheet("DG_Round_Log", [headers, ...rows]);
      }

      // DG Tournament
      {
        const s=appState.dg_tournament;
        const headers=["Date","Event","Course(s)","Division","Round Scores","Total Participants","Place","C1X %","C1 %","C2 %","Missed Inside 20ft","Notes","Takeaways"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.event||"",r.courses||"",r.division||"",r.roundScores||"",r.totalPlayers||"",r.place||"",r.c1x||"",r.c1||"",r.c2||"",r.miss20||"",r.notes||"",r.takeaways||""]);
        addSheet("DG_Tournament_Log", [headers, ...rows]);
      }

      // VetsDG
      {
        const s=appState.vetsdg;
        const headers=["Date","Entry Type","Event Name/Organization","Category","Sponsors","Outreach","Attendance","Donation","Contact Status","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.entryType||"",r.eventName||"",r.category||"",r.sponsors||"",r.outreach||"",r.attendance||"",r.donation||"",r.contactStatus||"",r.notes||""]);
        addSheet("VetsDG_Tracker", [headers, ...rows]);
      }

      // YouTube sheets (from spreadsheet)
      {
        const ytGroup = appConfig.groups.find(g=>g.id==="youtube");
        (ytGroup ? ytGroup.tabs : []).forEach(t=>{
          const sh = YT_BOOK.sheets[t.sheet] || { headers:[], rows:[] };
          const headers = sh.headers || [];
          const rows = (t.editable ? ((appState[t.id] && appState[t.id].rows) || []) : (sh.rows || []));
          addSheet("YouTube_" + String(t.sheet||"").replace(/[^a-z0-9]+/gi,"_").replace(/^_+|_+$/g,""), headers, rows);
        });
      }
// Guitar
      {
        const s=appState.guitar;
        const headers=["Date","Practice Length (mins)","Focus Area","Technique Skill","BPM Goal","BPM Achieved","BPM Success %","Song/Exercise","Difficulty (1-5)","Feeling","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.length||"",r.focus||"",r.technique||"",r.bpmGoal||"",r.bpmAchieved||"",r.bpmSuccess||"",r.song||"",r.difficulty||"",r.feeling||"",r.notes||""]);
        addSheet("GuitarPractice_Tracker", [headers, ...rows]);
      }

      // Certs
      {
        const s=appState.certs;
        const headers=["Date","Cert (CRISC/PMP)","Domain/Topic","Study Time (min)","Practice Qs %","Practice Exam Name","Score","Weak Areas","Notes"];
        const rows=(s.entries||[]).map(r=>[r.date||"",r.cert||"",r.domain||"",r.studyTime||"",r.practicePct||"",r.examName||"",r.score||"",r.weakAreas||"",r.notes||""]);
        addSheet("Certs_Tracker", [headers, ...rows]);
      }

      XLSX.writeFile(wb, "Yearly_Life_Betterment_All.xlsx");
    }

function iconSvg(kind){
      if(kind==="life")return `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 20h14M5 10h14M5 4h14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path></svg>`;
      if(kind==="health")return `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 21s-6-4.35-9-8.4C1 9 2.5 5.5 6 5.5c2 0 3.5 1.5 3.9 2.1C10.5 7 12 5.5 14 5.5c3.5 0 5 3.5 3 7.1-3 4.05-9 8.4-9 8.4z" fill="none" stroke="currentColor" stroke-width="2"></path></svg>`;
      if(kind==="disc")return `<svg viewBox="0 0 24 24" aria-hidden="true"><ellipse cx="12" cy="7" rx="8" ry="3" fill="none" stroke="currentColor" stroke-width="2"></ellipse><path d="M4 7v6c0 1.66 3.58 3 8 3s8-1.34 8-3V7" fill="none" stroke="currentColor" stroke-width="2"></path><path d="M4 13v4c0 1.66 3.58 3 8 3s8-1.34 8-3v-4" fill="none" stroke="currentColor" stroke-width="2"></path></svg>`;
      if(kind==="youtube")return `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 7.5C4 6.12 5.12 5 6.5 5h11C18.88 5 20 6.12 20 7.5v9c0 1.38-1.12 2.5-2.5 2.5h-11C5.12 19 4 17.88 4 16.5v-9z" fill="none" stroke="currentColor" stroke-width="2"></path><path d="M10 9l5 3-5 3V9z" fill="currentColor"></path></svg>`;
      if(kind==="skills")return `<svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3l2.09 4.24L19 8.27l-3.5 3.41L16.18 17 12 14.9 7.82 17l.68-5.32L5 8.27l4.91-1.03L12 3z" fill="none" stroke="currentColor" stroke-width="2"></path></svg>`;
      return `<svg viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"></circle></svg>`;
    }

    function renderGroupNav(){
      const strip=document.getElementById("groupStrip"); strip.innerHTML="";
      appConfig.groups.forEach(g=>{
        const b=document.createElement("button");
        b.type="button"; b.className="group-chip"+(g.id===appState.activeGroup?" active":"");
        b.textContent=g.label;
        b.addEventListener("click",()=>setActiveGroup(g.id));
        strip.appendChild(b);
      });
    }
    function renderTabNav(){
      const strip=document.getElementById("tabStrip"); strip.innerHTML="";
      const group=appConfig.groups.find(g=>g.id===appState.activeGroup)||appConfig.groups[0];
      group.tabs.forEach(t=>{
        const b=document.createElement("button");
        b.type="button"; b.className="tab-chip"+(t.id===appState.activeTab?" active":"");
        b.textContent=t.label;
        b.addEventListener("click",()=>setActiveTab(t.id));
        strip.appendChild(b);
      });
    }
    function renderBottomNav(){
      const nav=document.getElementById("bottomNav"); nav.innerHTML="";
      appConfig.groups.forEach(g=>{
        const b=document.createElement("button");
        b.type="button"; b.className="nav-btn"+(g.id===appState.activeGroup?" active":"");
        b.innerHTML=iconSvg(g.icon)+`<span>${g.label}</span>`;
        b.addEventListener("click",()=>setActiveGroup(g.id));
        nav.appendChild(b);
      });
    }

    function setActiveGroup(groupId){
      appState.activeGroup=groupId;
      const group=appConfig.groups.find(g=>g.id===groupId)||appConfig.groups[0];
      if(!appState.activeTab || tabConfigs[appState.activeTab].groupId!==groupId) appState.activeTab=group.tabs[0].id;
      saveState(); renderGroupNav(); renderTabNav(); renderBottomNav(); renderScreen();
    }
    function setActiveTab(tabId){
      if(!tabConfigs[tabId])return;
      appState.activeTab=tabId; appState.activeGroup=tabConfigs[tabId].groupId;
      saveState(); renderGroupNav(); renderTabNav(); renderBottomNav(); renderScreen();
    }

    function toNumber(val){ const n=parseFloat(val); return isNaN(n)?0:n; }
    function avg(nums){ const f=nums.filter(n=>!isNaN(n)); return f.length?f.reduce((a,b)=>a+b,0)/f.length:0; }
    function todayISO(){ return new Date().toISOString().slice(0,10); }

    function renderScreen(){
      const container=document.getElementById("screenContainer");
      const tab=tabConfigs[appState.activeTab];
      if(!tab){ container.innerHTML="<p style='padding:12px;color:var(--text-muted)'>No tab selected.</p>"; return; }

      let node;
      switch(tab.type){
        case "weekGrid": node=renderWeekTracker(); break;
        case "yt_sheet": node=renderYTSheet(tab); break;
        case "log_personal": node=renderPersonalTracker(); break;
        case "log_highlights": node=renderHighlights(); break;
        case "log_month": node=renderMonthView(); break;
        case "log_weight": node=renderWeightFitness(); break;
        case "log_mammoth": node=renderMammoth(); break;
        case "ref_marathon": node=renderMarathonPlanRef(); break;
        case "log_dg_practice": node=renderDGPractice(); break;
        case "log_dg_round": node=renderDGRound(); break;
        case "log_dg_tournament": node=renderDGTournament(); break;
        case "log_vetsdg": node=renderVetsDG(); break;
        case "log_youtube": node=renderYouTubeTracker(); break;
        case "log_yt_ideas": node=renderYTIdeas(); break;
        case "template_long": node=renderYTLongTemplate(); break;
        case "template_short": node=renderYTShortTemplate(); break;
        case "log_guitar": node=renderGuitar(); break;
        case "log_certs": node=renderCerts(); break;
        default:
          node=document.createElement("div");
          node.className="card";
          node.innerHTML="<div class='card-header'><h2>Not implemented</h2><span>Screen coming soon</span></div>";
      }
      container.innerHTML=""; container.appendChild(node);
    }

    // Helpers
    function makeDateInput(value,onChange){
      const i=document.createElement("input");
      i.type="date"; i.className="log-input"; i.value=value||""; i.addEventListener("input",()=>onChange(i.value)); return i;
    }
    function makeTextInput(value,placeholder,onChange){
      const i=document.createElement("input");
      i.type="text"; i.className="log-input"; i.value=value||""; if(placeholder) i.placeholder=placeholder;
      i.addEventListener("input",()=>onChange(i.value)); return i;
    }
    function makeNumberInput(value,step,min,onChange){
      const i=document.createElement("input");
      i.type="number"; i.className="log-input"; i.inputMode="decimal";
      if(step!=null) i.step=step; if(min!=null) i.min=min; i.value=value||"";
      i.addEventListener("input",()=>onChange(i.value)); return i;
    }
    function makeSelect(options,value,onChange){
      const s=document.createElement("select"); s.className="log-input";
      options.forEach(opt=>{ const o=document.createElement("option"); o.value=opt; o.textContent=opt||""; if((value||"")===opt) o.selected=true; s.appendChild(o);});
      s.addEventListener("change",()=>onChange(s.value)); return s;
    }
    function makeTextarea(value,placeholder,onChange,isBig){
      const ta=document.createElement("textarea"); ta.className="log-input"+(isBig?" big":""); ta.value=value||""; if(placeholder) ta.placeholder=placeholder;
      ta.addEventListener("input",()=>onChange(ta.value)); return ta;
    }
    function makeCell(child){ const td=document.createElement("td"); td.appendChild(child); return td; }

    // Week tracker
    function renderWeekTracker(){
      const tabId="week_tracker";
      const state=appState[tabId];
      const numericRowIds=new Set(["hike","weight","water","sleep","mm_distance","mm_pack_weight"]);

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>Weekly Habit Grid</h2><span>Numeric rows + Yes/No habits.</span></div>
        <button type="button" class="week-pill" id="weekLabelBtn"><span>Week:</span><strong>${state.weekLabel||"This Week"}</strong></button>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      const thead=document.createElement("thead");
      const hr=document.createElement("tr");
      hr.innerHTML="<th>Category</th>"+appConfig.weekly.days.map(d=>`<th>${d}</th>`).join("")+"<th>Weekly Total</th>";
      thead.appendChild(hr); table.appendChild(thead);

      const tbody=document.createElement("tbody");
      let overallTotal=0;

      appConfig.weekly.rows.forEach(row=>{
        const tr=document.createElement("tr");
        const label=document.createElement("td"); label.className="category-label";
        label.innerHTML=row.label+(row.summary?`<span>${row.summary}</span>`:"");
        tr.appendChild(label);

        let rowTotal=0;

        appConfig.weekly.days.forEach(day=>{
          const td=document.createElement("td");
          const stored=(state.data[row.id] && state.data[row.id][day]) || "";

          if(numericRowIds.has(row.id)){
            const input=document.createElement("input");
            input.type="number"; input.inputMode="decimal"; input.min="0"; input.step="0.01";
            input.className="small-input"; input.value=stored;
            if(stored!=="" && !isNaN(parseFloat(stored))) rowTotal+=parseFloat(stored);
            input.addEventListener("input",()=>{
              if(!state.data[row.id]) state.data[row.id]={};
              state.data[row.id][day]=input.value;
              saveState(); renderScreen();
            });
            td.appendChild(input);
          } else {
            const sel=document.createElement("select"); sel.className="small-input";
            ["","Yes","No"].forEach(v=>{ const o=document.createElement("option"); o.value=v; o.textContent=v||""; if(stored===v) o.selected=true; sel.appendChild(o);});
            sel.addEventListener("change",()=>{
              if(!state.data[row.id]) state.data[row.id]={};
              state.data[row.id][day]=sel.value;
              saveState();
            });
            td.appendChild(sel);
          }

          tr.appendChild(td);
        });

        overallTotal+=rowTotal;

        const totalTd=document.createElement("td");
        totalTd.className="summary-value";
        totalTd.textContent=rowTotal ? rowTotal.toFixed(2).replace(/\.00$/,"" ) : "â€“";
        tr.appendChild(totalTd);

        tbody.appendChild(tr);
      });

      const sumTr=document.createElement("tr"); sumTr.className="summary-row";
      const sumLabel=document.createElement("td"); sumLabel.className="summary-label"; sumLabel.textContent="Overall total (numeric rows only)";
      sumTr.appendChild(sumLabel);
      appConfig.weekly.days.forEach(()=>sumTr.appendChild(document.createElement("td")));
      const sumVal=document.createElement("td"); sumVal.className="summary-value"; sumVal.textContent=overallTotal ? overallTotal.toFixed(2).replace(/\.00$/,"" ) : "â€“";
      sumTr.appendChild(sumVal); tbody.appendChild(sumTr);

      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent="Export CSV (Week_Tracker only)";
      exportBtn.addEventListener("click",()=>{
        const headers=["Category",...appConfig.weekly.days,"Weekly Summary"];
        const rows=appConfig.weekly.rows.map(r=>{
          const rd=[r.label];
          appConfig.weekly.days.forEach(d=>rd.push((state.data[r.id] && state.data[r.id][d]) || ""));
          rd.push(r.summary||"");
          return rd;
        });
        exportCsv(headers,rows,"Week_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn=document.createElement("button"); clearBtn.type="button"; clearBtn.className="btn btn-danger"; clearBtn.textContent="Clear week";
      clearBtn.addEventListener("click",()=>{ if(confirm("Clear all values for this week?")){ appState[tabId]={weekLabel:state.weekLabel,data:{}}; saveState(); renderScreen(); }});
      controls.appendChild(clearBtn);
      section.appendChild(controls);

      const helper=document.createElement("div"); helper.className="helper-text";
      helper.innerHTML=`<div class="helper-dot"></div><div><strong>Numeric:</strong> Hike, Weight, Water, Sleep, MM Distance, MM Pack Weight. Everything else is <strong>Yes/No</strong>.</div>`;
      section.appendChild(helper);

      const analytics=document.createElement("div"); analytics.className="analytics-grid";
      analytics.innerHTML=`<div class="analytics-card"><div class="analytics-label">Total numeric entries</div><div class="analytics-value">${overallTotal?overallTotal.toFixed(1):"0.0"}</div></div>
        <div class="analytics-card"><div class="analytics-label">Tracked categories</div><div class="analytics-value">${appConfig.weekly.rows.length}</div></div>`;
      section.appendChild(analytics);

      setTimeout(()=>{
        const btn=document.getElementById("weekLabelBtn");
        if(btn){
          btn.addEventListener("click",()=>{
            const cur=state.weekLabel||"This Week";
            const next=prompt("Set a label for this week (e.g., 'Week 1 Â· Jan 1â€“7'):",cur);
            if(next!==null && next.trim()!==""){ state.weekLabel=next.trim(); saveState(); renderScreen(); }
          });
        }
      },0);

      return section;
    }

    function renderPersonalTracker(){
      const tabId="personal_tracker";
      const state=appState[tabId];
      const entries=state.entries||[];

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>Daily Personal Tracker</h2><span>Sleep, stress, energy, mood, gratitude & wins.</span></div><div class="badge"><span>${entries.length}</span> days logged</div>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      table.innerHTML=`<thead><tr>
          <th>Date</th><th>Sleep (hrs)</th><th>Stress (1-5)</th><th>Energy (1-5)</th><th>Mood (1-5)</th>
          <th>Self-Care?</th><th>Movement?</th><th>Screen Time?</th>
          <th>Gratitude</th><th>Intentions</th><th>Wins Today</th><th>Notes</th>
        </tr></thead>`;
      const tbody=document.createElement("tbody");

      entries.forEach(row=>{
        const tr=document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date,v=>{row.date=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(row.sleep,"0.1","0",v=>{row.sleep=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(row.stress,"1","1",v=>{row.stress=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(row.energy,"1","1",v=>{row.energy=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(row.mood,"1","1",v=>{row.mood=v;saveState();})));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"],row.selfCare,v=>{row.selfCare=v;saveState();})));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"],row.movement,v=>{row.movement=v;saveState();})));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"],row.screenControl,v=>{row.screenControl=v;saveState();})));
        tr.appendChild(makeCell(makeTextarea(row.gratitude,"",v=>{row.gratitude=v;saveState();},true)));
        tr.appendChild(makeCell(makeTextarea(row.intentions,"",v=>{row.intentions=v;saveState();},true)));
        tr.appendChild(makeCell(makeTextarea(row.winsToday,"",v=>{row.winsToday=v;saveState();},true)));
        tr.appendChild(makeCell(makeTextarea(row.notes,"",v=>{row.notes=v;saveState();},true)));
        tbody.appendChild(tr);
      });

      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const addBtn=document.createElement("button"); addBtn.type="button"; addBtn.className="btn btn-primary"; addBtn.textContent="Add Day";
      addBtn.addEventListener("click",()=>{
        state.entries.push({date:todayISO(),sleep:"",stress:"",energy:"",mood:"",selfCare:"",movement:"",screenControl:"",gratitude:"",intentions:"",winsToday:"",notes:""});
        saveState(); renderScreen();
      });
      controls.appendChild(addBtn);

      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent="Export CSV (Personal_Tracker)";
      exportBtn.addEventListener("click",()=>{
        const headers=["Date","Sleep (hrs)","Stress (1-5)","Energy (1-5)","Mood (1-5)","Self-Care Completed (Yes/No)","Daily Movement (Yes/No)","Screen Time Control (Yes/No)","Gratitude","Intentions for Tomorrow","Wins Today","Notes"];
        const rows=(state.entries||[]).map(r=>[r.date||"",r.sleep||"",r.stress||"",r.energy||"",r.mood||"",r.selfCare||"",r.movement||"",r.screenControl||"",r.gratitude||"",r.intentions||"",r.winsToday||"",r.notes||""]);
        exportCsv(headers,rows,"Personal_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn=document.createElement("button"); clearBtn.type="button"; clearBtn.className="btn btn-danger"; clearBtn.textContent="Clear All";
      clearBtn.addEventListener("click",()=>{ if(confirm("Clear all personal tracker rows?")){ state.entries=[]; saveState(); renderScreen(); }});
      controls.appendChild(clearBtn);
      section.appendChild(controls);

      const analytics=document.createElement("div"); analytics.className="analytics-grid";
      const sleeps=entries.map(r=>toNumber(r.sleep));
      const stress=entries.map(r=>toNumber(r.stress));
      const mood=entries.map(r=>toNumber(r.mood));
      analytics.innerHTML=`<div class="analytics-card"><div class="analytics-label">Avg Sleep (hrs)</div><div class="analytics-value">${entries.length?avg(sleeps).toFixed(1):"0.0"}</div></div>
        <div class="analytics-card"><div class="analytics-label">Avg Stress (1â€“5)</div><div class="analytics-value">${entries.length?avg(stress).toFixed(1):"0.0"}</div></div>
        <div class="analytics-card"><div class="analytics-label">Avg Mood (1â€“5)</div><div class="analytics-value">${entries.length?avg(mood).toFixed(1):"0.0"}</div></div>`;
      section.appendChild(analytics);

      return section;
    }

    function renderHighlights(){
      const tabId="highlights";
      const state=appState[tabId];
      const entries=state.entries||[];

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>Weekly Highlights & Wins</h2><span>One row per week with space to write.</span></div><div class="badge"><span>${entries.length}</span> weeks</div>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      table.innerHTML=`<thead><tr>
          <th>Week Starting</th><th>Biggest Win</th><th>Health/Fitness Win</th><th>Disc Golf Win</th>
          <th>YouTube Win</th><th>Vets DG Win</th><th>Guitar Win</th><th>Mindset Win</th><th>Notes</th>
        </tr></thead>`;
      const tbody=document.createElement("tbody");
      entries.forEach(row=>{
        const tr=document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.weekStarting,v=>{row.weekStarting=v;saveState();})));
        ["biggestWin","healthWin","dgWin","ytWin","vetsWin","guitarWin","mindsetWin","notes"].forEach(k=>{
          tr.appendChild(makeCell(makeTextarea(row[k],"",v=>{row[k]=v;saveState();},true)));
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const addBtn=document.createElement("button"); addBtn.type="button"; addBtn.className="btn btn-primary"; addBtn.textContent="Add Week";
      addBtn.addEventListener("click",()=>{ state.entries.push({weekStarting:"",biggestWin:"",healthWin:"",dgWin:"",ytWin:"",vetsWin:"",guitarWin:"",mindsetWin:"",notes:""}); saveState(); renderScreen();});
      controls.appendChild(addBtn);

      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent="Export CSV (Highlights_Wins)";
      exportBtn.addEventListener("click",()=>{
        const headers=["Week Starting","Biggest Win","Health/Fitness Win","Disc Golf Win","YouTube Win","Vets DG Win","Guitar Win","Mindset Win","Notes"];
        const rows=(state.entries||[]).map(r=>[r.weekStarting||"",r.biggestWin||"",r.healthWin||"",r.dgWin||"",r.ytWin||"",r.vetsWin||"",r.guitarWin||"",r.mindsetWin||"",r.notes||""]);
        exportCsv(headers,rows,"Highlights_Wins.csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn=document.createElement("button"); clearBtn.type="button"; clearBtn.className="btn btn-danger"; clearBtn.textContent="Clear All";
      clearBtn.addEventListener("click",()=>{ if(confirm("Clear all weekly highlights?")){ state.entries=[]; saveState(); renderScreen(); }});
      controls.appendChild(clearBtn);

      section.appendChild(controls);
      return section;
    }

    function renderMonthView(){
      // quick + usable version: generic
      return renderGenericLog({
        tabId:"month_view",
        title:"Month View",
        subtitle:"One row per month summary.",
        exportFilename:"Month_View",
        addDefaults:()=>({}),
        columns:[
          {key:"month",label:"Month",type:"text"},
          {key:"grade",label:"Grade",type:"text"},
          {key:"weightChange",label:"Weight Î”",type:"number",step:"0.1",min:"-999"},
          {key:"stepsMiles",label:"Steps/Miles",type:"text"},
          {key:"dgSessions",label:"DG Sessions",type:"number",step:"1",min:"0"},
          {key:"puttingAvg",label:"Putting Avg",type:"text"},
          {key:"fieldworkSessions",label:"Fieldwork",type:"number",step:"1",min:"0"},
          {key:"tournResults",label:"Tourn Results",type:"textarea"},
          {key:"mammothMiles",label:"Mammoth Miles",type:"number",step:"0.1",min:"0"},
          {key:"ytUploads",label:"YT Uploads",type:"number",step:"1",min:"0"},
          {key:"ytCtr",label:"YT CTR",type:"number",step:"0.1",min:"0"},
          {key:"ytSubsChange",label:"YT Subs Î”",type:"number",step:"1",min:"-999"},
          {key:"vetEvents",label:"Vet Events",type:"number",step:"1",min:"0"},
          {key:"vetMembersChange",label:"Vet Members Î”",type:"number",step:"1",min:"-999"},
          {key:"guitarHours",label:"Guitar Hours",type:"number",step:"0.1",min:"0"},
          {key:"guitarBpmDelta",label:"Guitar BPM Î”",type:"number",step:"1",min:"-999"},
          {key:"mentalAvg",label:"Mental Avg",type:"number",step:"0.1",min:"0"},
          {key:"sleepAvg",label:"Sleep Avg",type:"number",step:"0.1",min:"0"},
          {key:"stressAvg",label:"Stress Avg",type:"number",step:"0.1",min:"0"},
          {key:"restDays",label:"Rest Days",type:"number",step:"1",min:"0"},
          {key:"workLifeScore",label:"Work/Life",type:"number",step:"0.1",min:"0"},
          {key:"bigWins",label:"Wins",type:"textarea"},
          {key:"challenges",label:"Challenges",type:"textarea"},
          {key:"lessons",label:"Lessons",type:"textarea"},
          {key:"adjustments",label:"Adjustments",type:"textarea"},
          {key:"notes",label:"Notes",type:"textarea"},
          {key:"monthScore",label:"Score (0â€“1)",type:"number",step:"0.01",min:"0"}
        ]
      });
    }

    function renderWeightFitness(){
      const tabId="weight_fitness";
      const state=appState[tabId];
      const entries=state.entries||[];

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>Weight & Steps</h2><span>Daily weight, steps, walks, workouts.</span></div><div class="badge"><span>${entries.length}</span> days</div>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      table.innerHTML=`<thead><tr>
        <th>Date</th><th>Weight</th><th>Steps</th><th>Did You Walk</th><th>Miles</th><th>Did You Workout</th><th>Total Calories</th><th>Notes</th>
      </tr></thead>`;
      const tbody=document.createElement("tbody");

      entries.forEach(r=>{
        const tr=document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(r.date,v=>{r.date=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(r.weight,"0.1","0",v=>{r.weight=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(r.steps,"1","0",v=>{r.steps=v;saveState();})));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"],r.didWalk,v=>{r.didWalk=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(r.miles,"0.1","0",v=>{r.miles=v;saveState();})));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"],r.didWorkout,v=>{r.didWorkout=v;saveState();})));
        tr.appendChild(makeCell(makeNumberInput(r.calories,"1","0",v=>{r.calories=v;saveState();})));
        tr.appendChild(makeCell(makeTextarea(r.notes,"",v=>{r.notes=v;saveState();})));
        tbody.appendChild(tr);
      });

      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const addBtn=document.createElement("button"); addBtn.type="button"; addBtn.className="btn btn-primary"; addBtn.textContent="Add Day";
      addBtn.addEventListener("click",()=>{ state.entries.push({date:todayISO()}); saveState(); renderScreen(); });
      controls.appendChild(addBtn);

      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent="Export CSV (Weight_Fitness)";
      exportBtn.addEventListener("click",()=>{
        const headers=["Date","Weight","Steps","Did You Walk","Miles","Did You Workout","Total Calories","Notes"];
        const rows=(state.entries||[]).map(r=>[r.date||"",r.weight||"",r.steps||"",r.didWalk||"",r.miles||"",r.didWorkout||"",r.calories||"",r.notes||""]);
        exportCsv(headers,rows,"Weight_Fitness.csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn=document.createElement("button"); clearBtn.type="button"; clearBtn.className="btn btn-danger"; clearBtn.textContent="Clear All";
      clearBtn.addEventListener("click",()=>{ if(confirm("Clear all weight/fitness rows?")){ state.entries=[]; saveState(); renderScreen(); }});
      controls.appendChild(clearBtn);
      section.appendChild(controls);

      return section;
    }

    function renderGenericLog({tabId,title,subtitle,columns,exportFilename,addDefaults,autoDateField=null}){
      const state=appState[tabId];
      const entries=state.entries||[];

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>${title}</h2><span>${subtitle||""}</span></div><div class="badge"><span>${entries.length}</span> rows</div>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      const thead=document.createElement("thead");
      const trh=document.createElement("tr");
      columns.forEach(c=>{ const th=document.createElement("th"); th.textContent=c.label; trh.appendChild(th);});
      thead.appendChild(trh); table.appendChild(thead);

      const tbody=document.createElement("tbody");
      entries.forEach(row=>{
        const tr=document.createElement("tr");
        columns.forEach(col=>{
          const set=(nv)=>{ row[col.key]=nv; saveState(); };
          const v=row[col.key];
          let cell;
          if(col.type==="date") cell=makeDateInput(v,set);
          else if(col.type==="number") cell=makeNumberInput(v,col.step||"1",col.min||"0",set);
          else if(col.type==="select") cell=makeSelect(col.options||["","Yes","No"],v,set);
          else if(col.type==="textarea") cell=makeTextarea(v,"",set,!!col.big);
          else cell=makeTextInput(v,"",set);
          tr.appendChild(makeCell(cell));
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const addBtn=document.createElement("button"); addBtn.type="button"; addBtn.className="btn btn-primary"; addBtn.textContent="Add Row";
      addBtn.addEventListener("click",()=>{
        const base=(typeof addDefaults==="function")?addDefaults():(addDefaults||{});
        if(autoDateField && !base[autoDateField]) base[autoDateField]=todayISO();
        state.entries.push(base); saveState(); renderScreen();
      });
      controls.appendChild(addBtn);

      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent=`Export CSV (${exportFilename})`;
      exportBtn.addEventListener("click",()=>{
        const headers=columns.map(c=>c.exportHeader||c.label);
        const rows=(state.entries||[]).map(r=>columns.map(c=>r[c.key]||""));
        exportCsv(headers,rows,exportFilename+".csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn=document.createElement("button"); clearBtn.type="button"; clearBtn.className="btn btn-danger"; clearBtn.textContent="Clear All";
      clearBtn.addEventListener("click",()=>{ if(confirm("Clear all rows?")){ state.entries=[]; saveState(); renderScreen(); }});
      controls.appendChild(clearBtn);
      section.appendChild(controls);

      return section;
    }

    // Remaining tabs (generic)
    function renderMammoth(){ return renderGenericLog({ tabId:"mammoth", title:"Mammoth Tracker", subtitle:"Weekly hiking prep & gear notes.", exportFilename:"Mammoth_Tracker", addDefaults:()=>({}), columns:[
      {key:"week",label:"Week #",type:"text"},{key:"goalLong",label:"Long Hike Goal",type:"text"},{key:"actualLong",label:"Actual Long Day Distance",type:"number",step:"0.1",min:"0"},
      {key:"goalHit",label:"Goal Hit",type:"select",options:["","Yes","No"]},{key:"totalMilesWeek",label:"Total Miles Week",type:"number",step:"0.1",min:"0"},
      {key:"packWeight",label:"Pack Weight (lb)",type:"number",step:"0.1",min:"0"},{key:"hydra",label:"Hydration",type:"text"},{key:"fuelTested",label:"Fuel Tested",type:"text"},
      {key:"terrain",label:"Terrain",type:"text"},{key:"blisters",label:"Blisters (Y/N)",type:"select",options:["","Yes","No"]},{key:"gearNotes",label:"Gear Notes",type:"textarea"}
    ]});}
    function renderDGPractice(){ return renderGenericLog({ tabId:"dg_practice", title:"Disc Golf Practice Log", subtitle:"Track skill work and reps.", exportFilename:"DG_Practice_Log", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"duration",label:"Duration (min)",type:"number",step:"1",min:"0"},{key:"sessionType",label:"Session Type",type:"text"},{key:"focusSkill",label:"Focus Skill",type:"text"},
      {key:"discs",label:"Discs Used",type:"text"},{key:"c1Att",label:"C1 Att",type:"number",step:"1",min:"0"},{key:"c1Made",label:"C1 Made",type:"number",step:"1",min:"0"},
      {key:"c2Att",label:"C2 Att",type:"number",step:"1",min:"0"},{key:"c2Made",label:"C2 Made",type:"number",step:"1",min:"0"},{key:"fhReps",label:"FH Reps",type:"number",step:"1",min:"0"},
      {key:"bhReps",label:"BH Reps",type:"number",step:"1",min:"0"},{key:"notes",label:"Fieldwork Notes",type:"textarea"},{key:"wind",label:"Wind",type:"text"},{key:"fatigue",label:"Fatigue",type:"text"},{key:"result",label:"Result",type:"text"}
    ]});}
    function renderDGRound(){ return renderGenericLog({ tabId:"dg_round", title:"Disc Golf Round Log", subtitle:"Track course rounds and stats.", exportFilename:"DG_Round_Log", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"course",label:"Course",type:"text"},{key:"layout",label:"Layout",type:"text"},{key:"totalHoles",label:"Total Holes",type:"number",step:"1",min:"0"},
      {key:"par",label:"Par",type:"number",step:"1",min:"0"},{key:"score",label:"Score",type:"number",step:"1",min:"-999"},{key:"diffToPar",label:"Diff to Par",type:"number",step:"1",min:"-999"},
      {key:"c1Pct",label:"C1 %",type:"text"},{key:"c1xPct",label:"C1X %",type:"text"},{key:"c2Pct",label:"C2 %",type:"text"},{key:"miss20",label:"Misses <20ft",type:"number",step:"1",min:"0"},
      {key:"penalties",label:"Penalties",type:"number",step:"1",min:"0"},{key:"obs",label:"OBs",type:"number",step:"1",min:"0"},{key:"lostDiscs",label:"Lost Discs",type:"number",step:"1",min:"0"},{key:"wind",label:"Wind",type:"text"},{key:"notes",label:"Notes",type:"textarea"}
    ]});}
    function renderDGTournament(){ return renderGenericLog({ tabId:"dg_tournament", title:"Disc Golf Tournament Log", subtitle:"Track events, placements, and takeaways.", exportFilename:"DG_Tournament_Log", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"event",label:"Event",type:"text"},{key:"courses",label:"Course(s)",type:"text"},{key:"division",label:"Division",type:"text"},
      {key:"roundScores",label:"Round Scores",type:"text"},{key:"totalPlayers",label:"Total Participants",type:"number",step:"1",min:"0"},{key:"place",label:"Place",type:"text"},
      {key:"c1x",label:"C1X %",type:"text"},{key:"c1",label:"C1 %",type:"text"},{key:"c2",label:"C2 %",type:"text"},{key:"miss20",label:"Missed <20ft",type:"number",step:"1",min:"0"},
      {key:"notes",label:"Notes",type:"textarea"},{key:"takeaways",label:"Takeaways",type:"textarea"}
    ]});}
    function renderVetsDG(){ return renderGenericLog({ tabId:"vetsdg", title:"Vets DG Outreach", subtitle:"Track outreach, sponsors, and events.", exportFilename:"VetsDG_Tracker", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"entryType",label:"Entry Type",type:"text"},{key:"eventName",label:"Event/Org",type:"text"},{key:"category",label:"Category",type:"text"},{key:"sponsors",label:"Sponsors",type:"text"},
      {key:"outreach",label:"Outreach",type:"text"},{key:"attendance",label:"Attendance",type:"number",step:"1",min:"0"},{key:"donation",label:"Donation",type:"text"},{key:"contactStatus",label:"Contact Status",type:"text"},{key:"notes",label:"Notes",type:"textarea"}
    ]});}
    function renderYouTubeTracker(){ return renderGenericLog({ tabId:"yt_tracker", title:"YouTube Tracker", subtitle:"Track uploads, performance, and notes.", exportFilename:"YouTube_Tracker", addDefaults:()=>({}), columns:[
      {key:"week",label:"Week#",type:"text"},{key:"title",label:"Title",type:"text"},{key:"uploadDate",label:"Upload Date",type:"date"},{key:"length",label:"Length",type:"text"},
      {key:"videoType",label:"Video Type",type:"select",options:["","Long","Short"]},{key:"category",label:"Category",type:"text"},{key:"subcategory",label:"Subcategory",type:"text"},{key:"hook",label:"Hook",type:"text"},
      {key:"thumbnail",label:"Thumbnail",type:"text"},{key:"topic",label:"Topic",type:"text"},{key:"ctr",label:"CTR %",type:"number",step:"0.1",min:"0"},{key:"avgViewDur",label:"Avg View Duration",type:"text"},
      {key:"avgViewPct",label:"Avg View %",type:"number",step:"0.1",min:"0"},{key:"view7",label:"7 Day View",type:"number",step:"1",min:"0"},{key:"totalView",label:"Total View",type:"number",step:"1",min:"0"},
      {key:"subChange",label:"Sub Change",type:"number",step:"1",min:"-999"},{key:"videoScore",label:"Video Score",type:"text"},{key:"notes",label:"Notes",type:"textarea"}
    ]});}
    function renderYTIdeas(){ return renderGenericLog({ tabId:"yt_ideas", title:"YouTube Video Ideas", subtitle:"Brain dump, then pick weekly.", exportFilename:"Youtube_Video_Ideas", addDefaults:()=>({}), columns:[
      {key:"skill",label:"Skill Tutorial",type:"textarea"},{key:"gear",label:"Gear Review",type:"textarea"},{key:"courseGear",label:"Course Gear",type:"textarea"},{key:"lifestyle",label:"Lifestyle",type:"textarea"},
      {key:"beginner",label:"Beginner Tips",type:"textarea"},{key:"challenge",label:"Challenge",type:"textarea"},{key:"experimentation",label:"Experimentation",type:"textarea"},{key:"quick",label:"Quick Tip",type:"textarea"},{key:"ideas",label:"20 Video Ideas",type:"textarea",big:true}
    ]});}
    function renderYTLongTemplate(){ return renderGenericLog({ tabId:"yt_long_template", title:"Long Script Notes", subtitle:"Template + example per row.", exportFilename:"Long_Script_Template", addDefaults:()=>({}), columns:[
      {key:"template",label:"Long Script Template",type:"textarea",big:true},{key:"example",label:"Example",type:"textarea",big:true}
    ]});}
    function renderYTShortTemplate(){ return renderGenericLog({ tabId:"yt_short_template", title:"Short Script Notes", subtitle:"Template + example per row.", exportFilename:"Short_Script_Template", addDefaults:()=>({}), columns:[
      {key:"template",label:"Template",type:"textarea",big:true},{key:"example",label:"Example of Template",type:"textarea",big:true}
    ]});}
    function renderGuitar(){ return renderGenericLog({ tabId:"guitar", title:"Guitar Practice", subtitle:"Track sessions & BPM progress.", exportFilename:"GuitarPractice_Tracker", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"length",label:"Practice Length (mins)",type:"number",step:"1",min:"0"},{key:"focus",label:"Focus Area",type:"text"},{key:"technique",label:"Technique Skill",type:"text"},
      {key:"bpmGoal",label:"BPM Goal",type:"number",step:"1",min:"0"},{key:"bpmAchieved",label:"BPM Achieved",type:"number",step:"1",min:"0"},{key:"bpmSuccess",label:"BPM Success %",type:"number",step:"0.1",min:"0"},
      {key:"song",label:"Song/Exercise",type:"text"},{key:"difficulty",label:"Difficulty (1-5)",type:"number",step:"1",min:"1"},{key:"feeling",label:"Feeling",type:"text"},{key:"notes",label:"Notes",type:"textarea"}
    ]});}
    function renderCerts(){ return renderGenericLog({ tabId:"certs", title:"Certs Tracker", subtitle:"CRISC/PMP study tracking.", exportFilename:"Certs_Tracker", addDefaults:()=>({date:todayISO()}), autoDateField:"date", columns:[
      {key:"date",label:"Date",type:"date"},{key:"cert",label:"Cert",type:"text"},{key:"domain",label:"Domain/Topic",type:"text"},{key:"studyTime",label:"Study Time (min)",type:"number",step:"1",min:"0"},
      {key:"practicePct",label:"Practice Qs %",type:"number",step:"0.1",min:"0"},{key:"examName",label:"Practice Exam Name",type:"text"},{key:"score",label:"Score",type:"number",step:"0.1",min:"0"},{key:"weakAreas",label:"Weak Areas",type:"textarea"},{key:"notes",label:"Notes",type:"textarea"}
    ]});}

    
    function renderMarathonPlanRef(){
      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>Marathon Training Plan (Reference)</h2><span>Read-only table from your spreadsheet.</span></div>
        <div class="badge"><span>${marathonPlanRef.rows.length}</span> weeks</div>`;
      section.appendChild(header);

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      const thead=document.createElement("thead");
      const trh=document.createElement("tr");
      marathonPlanRef.headers.forEach(h=>{ const th=document.createElement("th"); th.textContent=h; trh.appendChild(th); });
      thead.appendChild(trh); table.appendChild(thead);

      const tbody=document.createElement("tbody");
      marathonPlanRef.rows.forEach(r=>{
        const tr=document.createElement("tr");
        r.forEach((cell,i)=>{ const td=document.createElement("td"); td.textContent=cell; td.style.textAlign = i===0 ? "center" : "left"; tr.appendChild(td); });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      wrap.appendChild(table);
      section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      const exportBtn=document.createElement("button"); exportBtn.type="button"; exportBtn.className="btn btn-primary"; exportBtn.textContent="Export CSV (Marathon Plan)";
      exportBtn.addEventListener("click",()=>{ exportCsv(marathonPlanRef.headers, marathonPlanRef.rows, "Marathon_Training_Plan.csv"); });
      controls.appendChild(exportBtn);
      section.appendChild(controls);

      return section;
    }


    function renderYTSheet(tab){
      const sheetName = tab.sheet;
      const sheet = YT_BOOK.sheets[sheetName] || { headers:[], rows:[] };
      const headers = sheet.headers || [];
      const readonly = !tab.editable;

      const section=document.createElement("section"); section.className="card";
      const header=document.createElement("div"); header.className="card-header";
      header.innerHTML=`<div><h2>${sheetName}</h2><span>${readonly ? "Reference (read-only)" : "Editable tracker"}</span></div>
        <div class="badge"><span>${(readonly ? sheet.rows.length : (appState[tab.id].rows||[]).length)}</span> rows</div>`;
      section.appendChild(header);

      const yesNoHeaders = new Set(["Filmed","Scheduled","Published","Done","Goal Hit","Did You Walk","Did You Workout"]);
      const pillars = (YT_BOOK.dropdowns && YT_BOOK.dropdowns.pillars) ? YT_BOOK.dropdowns.pillars : [];

      const getRows = ()=> readonly ? (sheet.rows||[]) : (appState[tab.id].rows||[]);
      const rows = getRows();

      const wrap=document.createElement("div"); wrap.className="table-wrapper";
      const table=document.createElement("table");
      const thead=document.createElement("thead");
      const trh=document.createElement("tr");
      headers.forEach(h=>{ const th=document.createElement("th"); th.textContent=h||""; trh.appendChild(th); });
      if(!readonly){ const th=document.createElement("th"); th.textContent=""; trh.appendChild(th); }
      thead.appendChild(trh); table.appendChild(thead);

      const tbody=document.createElement("tbody");

      function isDateLike(v){ return /^\\d{4}-\\d{2}-\\d{2}/.test(String(v||"")); }

      rows.forEach((row,rowIdx)=>{
        const tr=document.createElement("tr");
        headers.forEach((h,colIdx)=>{
          const val = (row && row[colIdx]!==undefined) ? row[colIdx] : "";
          const td=document.createElement("td");

          if(readonly){
            td.textContent = val;
          } else {
            // editable
            let control=null;
            const headerNorm = String(h||"").trim();

            if(headerNorm==="Pillar" && pillars.length){
              control = makeSelect(["", ...pillars], val, v=>{ row[colIdx]=v; saveState(); });
            } else if(yesNoHeaders.has(headerNorm)){
              control = makeSelect(["", "Yes", "No"], val, v=>{ row[colIdx]=v; saveState(); });
            } else if(headerNorm.toLowerCase().includes("date") || (headerNorm.toLowerCase().includes("week") && isDateLike(val))){
              const d = isDateLike(val) ? String(val).slice(0,10) : "";
              control = makeDateInput(d, v=>{ row[colIdx]=v; saveState(); });
            } else if(headerNorm.toLowerCase().includes("notes") || headerNorm.toLowerCase().includes("prompt") || headerNorm.toLowerCase().includes("description") || headerNorm.toLowerCase().includes("what to write")){
              control = makeTextarea(val,"", v=>{ row[colIdx]=v; saveState(); }, true);
            } else {
              control = makeTextInput(val,"", v=>{ row[colIdx]=v; saveState(); });
            }
            td.appendChild(control);
          }

          tr.appendChild(td);
        });

        if(!readonly){
          const td=document.createElement("td");
          const del=document.createElement("button"); del.type="button"; del.className="btn btn-danger"; del.textContent="Del";
          del.addEventListener("click",()=>{
            if(confirm("Delete this row?")){
              appState[tab.id].rows.splice(rowIdx,1);
              saveState(); renderScreen();
            }
          });
          td.appendChild(del); tr.appendChild(td);
        }

        tbody.appendChild(tr);
      });

      table.appendChild(tbody); wrap.appendChild(table); section.appendChild(wrap);

      const controls=document.createElement("div"); controls.className="controls-row";
      if(!readonly){
        const addBtn=document.createElement("button"); addBtn.type="button"; addBtn.className="btn btn-primary"; addBtn.textContent="Add Row";
        addBtn.addEventListener("click",()=>{
          const newRow = headers.map(()=> "");
          appState[tab.id].rows.push(newRow);
          saveState(); renderScreen();
        });
        controls.appendChild(addBtn);

        const resetBtn=document.createElement("button"); resetBtn.type="button"; resetBtn.className="btn"; resetBtn.textContent="Reset to template";
        resetBtn.addEventListener("click",()=>{
          if(confirm("Reset this sheet back to the spreadsheet template? This will overwrite your edits for this sheet.")){
            const seed = (YT_BOOK.sheets[sheetName] && YT_BOOK.sheets[sheetName].rows) ? YT_BOOK.sheets[sheetName].rows : [];
            appState[tab.id].rows = JSON.parse(JSON.stringify(seed));
            saveState(); renderScreen();
          }
        });
        controls.appendChild(resetBtn);
      }
      section.appendChild(controls);

      return section;
    }

(function init(){
      renderGroupNav(); renderTabNav(); renderBottomNav(); renderScreen();
    })();
  
</script>
</body>
</html>
